<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Capítulo 8 Bayesian Cps | Control Estadístico de la Calidad</title>
  <meta name="description" content="Prácticas de la asignatura de Control Estadistico de la Calidad." />
  <meta name="generator" content="bookdown 0.13 and GitBook 2.6.7" />

  <meta property="og:title" content="Capítulo 8 Bayesian Cps | Control Estadístico de la Calidad" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Prácticas de la asignatura de Control Estadistico de la Calidad." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Capítulo 8 Bayesian Cps | Control Estadístico de la Calidad" />
  
  <meta name="twitter:description" content="Prácticas de la asignatura de Control Estadistico de la Calidad." />
  

<meta name="author" content="Miguel Flores Sánchez (miguel.flores@epn.edu.ec) Javier Tarrío-Saavedra (javier.tarrio@udc.es) Salvador Naya ()" />


<meta name="date" content="2019-09-23" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="apuntes-de-control-y-aseguramiento-de-la-calidad.html"/>
<link rel="next" href="control-no-parametrico.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Control Estadistico de la Calidad </a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Prólogo</a></li>
<li class="part"><span><b>I Teoria</b></span></li>
<li class="chapter" data-level="1" data-path="control-estadistico-de-la-calidad.html"><a href="control-estadistico-de-la-calidad.html"><i class="fa fa-check"></i><b>1</b> Control Estadistico de la Calidad</a><ul>
<li class="chapter" data-level="1.1" data-path="control-estadistico-de-la-calidad.html"><a href="control-estadistico-de-la-calidad.html#cec-y-seis-sigma-alternativas-en-r"><i class="fa fa-check"></i><b>1.1</b> CEC y seis Sigma: Alternativas en <em>R</em></a></li>
<li class="chapter" data-level="1.2" data-path="control-estadistico-de-la-calidad.html"><a href="control-estadistico-de-la-calidad.html#etapa-definir"><i class="fa fa-check"></i><b>1.2</b> Etapa <strong>DEFINIR</strong></a><ul>
<li class="chapter" data-level="1.2.1" data-path="control-estadistico-de-la-calidad.html"><a href="control-estadistico-de-la-calidad.html#mapa-de-procesos"><i class="fa fa-check"></i><b>1.2.1</b> Mapa de Procesos</a></li>
<li class="chapter" data-level="1.2.2" data-path="control-estadistico-de-la-calidad.html"><a href="control-estadistico-de-la-calidad.html#diagrama-de-ishikawa-o-espina-de-pescado"><i class="fa fa-check"></i><b>1.2.2</b> Diagrama de Ishikawa o espina de pescado</a></li>
<li class="chapter" data-level="1.2.3" data-path="control-estadistico-de-la-calidad.html"><a href="control-estadistico-de-la-calidad.html#diagrama-de-pareto"><i class="fa fa-check"></i><b>1.2.3</b> Diagrama de Pareto</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="control-estadistico-de-la-calidad.html"><a href="control-estadistico-de-la-calidad.html#epata-analizar-anova"><i class="fa fa-check"></i><b>1.3</b> Epata <strong>ANALIZAR</strong>: ANOVA</a><ul>
<li class="chapter" data-level="1.3.1" data-path="control-estadistico-de-la-calidad.html"><a href="control-estadistico-de-la-calidad.html#introduccion"><i class="fa fa-check"></i><b>1.3.1</b> Introducción</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="control-estadistico-de-la-calidad.html"><a href="control-estadistico-de-la-calidad.html#etapa-medir"><i class="fa fa-check"></i><b>1.4</b> Etapa <strong>MEDIR</strong></a><ul>
<li class="chapter" data-level="1.4.1" data-path="control-estadistico-de-la-calidad.html"><a href="control-estadistico-de-la-calidad.html#estudios-rr"><i class="fa fa-check"></i><b>1.4.1</b> Estudios R&amp;R</a></li>
</ul></li>
<li class="chapter" data-level="1.5" data-path="control-estadistico-de-la-calidad.html"><a href="control-estadistico-de-la-calidad.html#etapa-control"><i class="fa fa-check"></i><b>1.5</b> Etapa <strong>CONTROL</strong>:</a><ul>
<li class="chapter" data-level="1.5.1" data-path="control-estadistico-de-la-calidad.html"><a href="control-estadistico-de-la-calidad.html#graficos-de-control"><i class="fa fa-check"></i><b>1.5.1</b> Gráficos de control</a></li>
<li class="chapter" data-level="1.5.2" data-path="control-estadistico-de-la-calidad.html"><a href="control-estadistico-de-la-calidad.html#graficos-de-control-multivariantes"><i class="fa fa-check"></i><b>1.5.2</b> Gráficos de control multivariantes</a></li>
<li class="chapter" data-level="1.5.3" data-path="control-estadistico-de-la-calidad.html"><a href="control-estadistico-de-la-calidad.html#graficos-de-control-por-variables"><i class="fa fa-check"></i><b>1.5.3</b> Graficos de control por variables</a></li>
<li class="chapter" data-level="1.5.4" data-path="control-estadistico-de-la-calidad.html"><a href="control-estadistico-de-la-calidad.html#graficos-de-control-para-atributos"><i class="fa fa-check"></i><b>1.5.4</b> Gráficos de control para atributos</a></li>
<li class="chapter" data-level="1.5.5" data-path="control-estadistico-de-la-calidad.html"><a href="control-estadistico-de-la-calidad.html#otros-graficos-de-control-univariante"><i class="fa fa-check"></i><b>1.5.5</b> Otros graficos de Control univariante</a></li>
<li class="chapter" data-level="1.5.6" data-path="control-estadistico-de-la-calidad.html"><a href="control-estadistico-de-la-calidad.html#curvas-oc"><i class="fa fa-check"></i><b>1.5.6</b> Curvas OC</a></li>
</ul></li>
<li class="chapter" data-level="1.6" data-path="control-estadistico-de-la-calidad.html"><a href="control-estadistico-de-la-calidad.html#etapa-analizar-analisis-de-capacidad"><i class="fa fa-check"></i><b>1.6</b> Etapa <strong>ANALIZAR</strong>: Analisis de capacidad</a><ul>
<li class="chapter" data-level="1.6.1" data-path="control-estadistico-de-la-calidad.html"><a href="control-estadistico-de-la-calidad.html#introduccion-1"><i class="fa fa-check"></i><b>1.6.1</b> Introducción</a></li>
<li class="chapter" data-level="1.6.2" data-path="control-estadistico-de-la-calidad.html"><a href="control-estadistico-de-la-calidad.html#indices-de-capacidad"><i class="fa fa-check"></i><b>1.6.2</b> Indices de capacidad</a></li>
<li class="chapter" data-level="1.6.3" data-path="control-estadistico-de-la-calidad.html"><a href="control-estadistico-de-la-calidad.html#analisis-de-capacidad-en-r"><i class="fa fa-check"></i><b>1.6.3</b> Analisis de capacidad en R</a></li>
<li class="chapter" data-level="1.6.4" data-path="control-estadistico-de-la-calidad.html"><a href="control-estadistico-de-la-calidad.html#analisis-de-capacidad-con-datos-no-normales"><i class="fa fa-check"></i><b>1.6.4</b> Análisis de capacidad con datos no normales</a></li>
</ul></li>
<li class="chapter" data-level="1.7" data-path="control-estadistico-de-la-calidad.html"><a href="control-estadistico-de-la-calidad.html#etapa-controlar-y-analizar"><i class="fa fa-check"></i><b>1.7</b> Etapa <strong>CONTROLAR</strong> y <strong>ANALIZAR</strong></a><ul>
<li class="chapter" data-level="1.7.1" data-path="control-estadistico-de-la-calidad.html"><a href="control-estadistico-de-la-calidad.html#cec-multivariante-reduccion-de-la-dimencion"><i class="fa fa-check"></i><b>1.7.1</b> CEC multivariante: Reducción de la Dimención</a></li>
<li class="chapter" data-level="1.7.2" data-path="control-estadistico-de-la-calidad.html"><a href="control-estadistico-de-la-calidad.html#cec-para-variables-autocorrelacionadas"><i class="fa fa-check"></i><b>1.7.2</b> CEC para variables autocorrelacionadas</a></li>
<li class="chapter" data-level="1.7.3" data-path="control-estadistico-de-la-calidad.html"><a href="control-estadistico-de-la-calidad.html#analisis-de-capacidad-para-datos-autocorrelados"><i class="fa fa-check"></i><b>1.7.3</b> Análisis de capacidad para datos autocorrelados</a></li>
</ul></li>
<li class="chapter" data-level="1.8" data-path="control-estadistico-de-la-calidad.html"><a href="control-estadistico-de-la-calidad.html#introduccion-al-diseno-de-experimentos-con-r"><i class="fa fa-check"></i><b>1.8</b> Introducción al diseño de experimentos con R</a><ul>
<li class="chapter" data-level="1.8.1" data-path="control-estadistico-de-la-calidad.html"><a href="control-estadistico-de-la-calidad.html#ejemplos-de-contrastes-anova"><i class="fa fa-check"></i><b>1.8.1</b> Ejemplos de contrastes ANOVA</a></li>
<li class="chapter" data-level="1.8.2" data-path="control-estadistico-de-la-calidad.html"><a href="control-estadistico-de-la-calidad.html#diseno-de-experimentos-factorial-2k"><i class="fa fa-check"></i><b>1.8.2</b> Diseño de experimentos factorial <span class="math inline">\(2^k\)</span></a></li>
<li class="chapter" data-level="1.8.3" data-path="control-estadistico-de-la-calidad.html"><a href="control-estadistico-de-la-calidad.html#diseno-de-experimentos-factoriales-fraccionarios"><i class="fa fa-check"></i><b>1.8.3</b> Diseño de experimentos factoriales fraccionarios</a></li>
<li class="chapter" data-level="1.8.4" data-path="control-estadistico-de-la-calidad.html"><a href="control-estadistico-de-la-calidad.html#estudios-interlaboratorios"><i class="fa fa-check"></i><b>1.8.4</b> Estudios Interlaboratorios</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>II Practicas</b></span></li>
<li class="chapter" data-level="2" data-path="practica-1.html"><a href="practica-1.html"><i class="fa fa-check"></i><b>2</b> Práctica 1</a><ul>
<li class="chapter" data-level="2.1" data-path="practica-1.html"><a href="practica-1.html#cec-y-seis-signa-alternativas-en-r"><i class="fa fa-check"></i><b>2.1</b> CEC y Seis Signa: alternativas en R</a></li>
<li class="chapter" data-level="2.2" data-path="practica-1.html"><a href="practica-1.html#etapa-definir-mapas-de-procesos-ishikawa-pareto"><i class="fa fa-check"></i><b>2.2</b> Etapa <em>DEFINIR</em>: Mapas de procesos, Ishikawa, Pareto</a><ul>
<li class="chapter" data-level="2.2.1" data-path="practica-1.html"><a href="practica-1.html#pizza"><i class="fa fa-check"></i><b>2.2.1</b> Mapas de procesos</a></li>
<li class="chapter" data-level="2.2.2" data-path="practica-1.html"><a href="practica-1.html#ishikawa"><i class="fa fa-check"></i><b>2.2.2</b> DIAGRAMA DE ISHIKAWA</a></li>
<li class="chapter" data-level="2.2.3" data-path="practica-1.html"><a href="practica-1.html#par"><i class="fa fa-check"></i><b>2.2.3</b> DIAGRAMA DE PARETO</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="practica-1.html"><a href="practica-1.html#anova"><i class="fa fa-check"></i><b>2.3</b> Etapa <em>ANALIZAR</em>: ANOVA</a></li>
<li class="chapter" data-level="2.4" data-path="practica-1.html"><a href="practica-1.html#RyR"><i class="fa fa-check"></i><b>2.4</b> Etapa <em>MEDIR</em>: Estudios R&amp;R</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="practica-2.html"><a href="practica-2.html"><i class="fa fa-check"></i><b>3</b> Práctica 2</a><ul>
<li class="chapter" data-level="3.1" data-path="practica-2.html"><a href="practica-2.html#graficos-de-control-1"><i class="fa fa-check"></i><b>3.1</b> Gráficos de Control</a></li>
<li class="chapter" data-level="3.2" data-path="practica-2.html"><a href="practica-2.html#graficos-de-control-por-variables-1"><i class="fa fa-check"></i><b>3.2</b> Gráficos de Control por variables</a><ul>
<li class="chapter" data-level="3.2.1" data-path="practica-2.html"><a href="practica-2.html#gqcc"><i class="fa fa-check"></i><b>3.2.1</b> Gráficos qcc para variables</a></li>
<li class="chapter" data-level="3.2.2" data-path="practica-2.html"><a href="practica-2.html#grafico-de-control-para-el-rango-y-la-media-datos-plates"><i class="fa fa-check"></i><b>3.2.2</b> Gráfico de control para el RANGO y la MEDIA: datos “plates”</a></li>
<li class="chapter" data-level="3.2.3" data-path="practica-2.html"><a href="practica-2.html#renderizado"><i class="fa fa-check"></i><b>3.2.3</b> Grafico de control para valores individuales de las variables</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="practica-2.html"><a href="practica-2.html#graficos-de-control-por-atributos"><i class="fa fa-check"></i><b>3.3</b> Gráficos de control por atributos</a><ul>
<li class="chapter" data-level="3.3.1" data-path="practica-2.html"><a href="practica-2.html#P"><i class="fa fa-check"></i><b>3.3.1</b> Gráficos p</a></li>
<li class="chapter" data-level="3.3.2" data-path="practica-2.html"><a href="practica-2.html#np"><i class="fa fa-check"></i><b>3.3.2</b> Gráfico tipo np</a></li>
<li class="chapter" data-level="3.3.3" data-path="practica-2.html"><a href="practica-2.html#gc"><i class="fa fa-check"></i><b>3.3.3</b> Gráficos C</a></li>
<li class="chapter" data-level="3.3.4" data-path="practica-2.html"><a href="practica-2.html#gu"><i class="fa fa-check"></i><b>3.3.4</b> Gráficos U</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="practica-2.html"><a href="practica-2.html#otros-graficos-de-control-cusum-y-ewma"><i class="fa fa-check"></i><b>3.4</b> Otros gráficos de Control: CUSUM y EWMA</a><ul>
<li class="chapter" data-level="3.4.1" data-path="practica-2.html"><a href="practica-2.html#cusum"><i class="fa fa-check"></i><b>3.4.1</b> GRÀFICOS CUSUM</a></li>
<li class="chapter" data-level="3.4.2" data-path="practica-2.html"><a href="practica-2.html#ewma"><i class="fa fa-check"></i><b>3.4.2</b> GRÁFICOS EWMA</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="practica-2.html"><a href="practica-2.html#oc"><i class="fa fa-check"></i><b>3.5</b> CURVAS OC</a><ul>
<li class="chapter" data-level="3.5.1" data-path="practica-2.html"><a href="practica-2.html#curvas-oc-para-grafica-de-variables"><i class="fa fa-check"></i><b>3.5.1</b> Curvas OC para gráfica de variables</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="practica-3.html"><a href="practica-3.html"><i class="fa fa-check"></i><b>4</b> Práctica 3</a><ul>
<li class="chapter" data-level="4.1" data-path="practica-3.html"><a href="practica-3.html#etapa-analizar-analisis-de-la-capacidad"><i class="fa fa-check"></i><b>4.1</b> Etapa <em>ANALIZAR</em>: Análisis de la capacidad</a><ul>
<li class="chapter" data-level="4.1.1" data-path="practica-3.html"><a href="practica-3.html#analisis-de-capacidad-con-r"><i class="fa fa-check"></i><b>4.1.1</b> Análisis de capacidad con R:</a></li>
<li class="chapter" data-level="4.1.2" data-path="practica-3.html"><a href="practica-3.html#analisis-de-la-capacidad-con-datos-no-normales"><i class="fa fa-check"></i><b>4.1.2</b> Análisis de la capacidad con datos no normales</a></li>
<li class="chapter" data-level="4.1.3" data-path="practica-3.html"><a href="practica-3.html#Piedra"><i class="fa fa-check"></i><b>4.1.3</b> Caso Práctico</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="practica-4.html"><a href="practica-4.html"><i class="fa fa-check"></i><b>5</b> Práctica 4</a><ul>
<li class="chapter" data-level="5.1" data-path="practica-4.html"><a href="practica-4.html#etapa-controlar-y-analizar-1"><i class="fa fa-check"></i><b>5.1</b> Etapa Controlar y Analizar</a><ul>
<li class="chapter" data-level="5.1.1" data-path="practica-4.html"><a href="practica-4.html#control-estadistico-de-calidad-multivariante"><i class="fa fa-check"></i><b>5.1.1</b> Control Estadistico de Calidad Multivariante:</a></li>
<li class="chapter" data-level="5.1.2" data-path="practica-4.html"><a href="practica-4.html#control-de-calidad-de-variables-autocorreladas"><i class="fa fa-check"></i><b>5.1.2</b> Control de Calidad de variables autocorreladas</a></li>
<li class="chapter" data-level="5.1.3" data-path="practica-4.html"><a href="practica-4.html#autocorr"><i class="fa fa-check"></i><b>5.1.3</b> Análisis de capacidad con datos autocorrelados.</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="practica-5.html"><a href="practica-5.html"><i class="fa fa-check"></i><b>6</b> Práctica 5</a><ul>
<li class="chapter" data-level="6.1" data-path="practica-5.html"><a href="practica-5.html#introduccion-al-diseno-de-experimentos-con-r-1"><i class="fa fa-check"></i><b>6.1</b> Introducción al diseño de experimentos con R</a><ul>
<li class="chapter" data-level="6.1.1" data-path="practica-5.html"><a href="practica-5.html#ejemplos-de-pruebas-anova"><i class="fa fa-check"></i><b>6.1.1</b> Ejemplos de Pruebas ANOVA</a></li>
<li class="chapter" data-level="6.1.2" data-path="practica-5.html"><a href="practica-5.html#disenos-factoriales"><i class="fa fa-check"></i><b>6.1.2</b> DISEÑOS FACTORIALES</a></li>
<li class="chapter" data-level="6.1.3" data-path="practica-5.html"><a href="practica-5.html#disenos-de-experimentos-factoriales-fraccionados"><i class="fa fa-check"></i><b>6.1.3</b> DISEÑOS DE EXPERIMENTOS FACTORIALES FRACCIONADOS</a></li>
<li class="chapter" data-level="6.1.4" data-path="practica-5.html"><a href="practica-5.html#ilab"><i class="fa fa-check"></i><b>6.1.4</b> ESTUDIOS INTERLABORATORIO (CASO PARTICULAR DE DOE Y ESTUDIOS R&amp;R)</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>III Apuntes en Clase</b></span></li>
<li class="chapter" data-level="7" data-path="apuntes-de-control-y-aseguramiento-de-la-calidad.html"><a href="apuntes-de-control-y-aseguramiento-de-la-calidad.html"><i class="fa fa-check"></i><b>7</b> Apuntes de Control Y Aseguramiento de la Calidad</a><ul>
<li class="chapter" data-level="7.1" data-path="apuntes-de-control-y-aseguramiento-de-la-calidad.html"><a href="apuntes-de-control-y-aseguramiento-de-la-calidad.html#conceptos-basicos"><i class="fa fa-check"></i><b>7.1</b> <strong>Conceptos Básicos</strong></a></li>
<li class="chapter" data-level="7.2" data-path="apuntes-de-control-y-aseguramiento-de-la-calidad.html"><a href="apuntes-de-control-y-aseguramiento-de-la-calidad.html#estadistica-descriptiva"><i class="fa fa-check"></i><b>7.2</b> <strong>Estadística descriptiva</strong></a><ul>
<li class="chapter" data-level="7.2.1" data-path="apuntes-de-control-y-aseguramiento-de-la-calidad.html"><a href="apuntes-de-control-y-aseguramiento-de-la-calidad.html#medidas-de-tendencia-central"><i class="fa fa-check"></i><b>7.2.1</b> <strong>Medidas de tendencia central</strong></a></li>
<li class="chapter" data-level="7.2.2" data-path="apuntes-de-control-y-aseguramiento-de-la-calidad.html"><a href="apuntes-de-control-y-aseguramiento-de-la-calidad.html#medidas-de-dispersion-o-variabilidad"><i class="fa fa-check"></i><b>7.2.2</b> <strong>Medidas de dispersión o variabilidad </strong></a></li>
<li class="chapter" data-level="7.2.3" data-path="apuntes-de-control-y-aseguramiento-de-la-calidad.html"><a href="apuntes-de-control-y-aseguramiento-de-la-calidad.html#relacion-entre-barx-y-s-interpretacion-de-la-desviacion-estandar"><i class="fa fa-check"></i><b>7.2.3</b> <strong>Relación entre <span class="math inline">\(\bar{X}\)</span> y <span class="math inline">\(S\)</span> (interpretación de la desviación estándar)</strong></a></li>
<li class="chapter" data-level="7.2.4" data-path="apuntes-de-control-y-aseguramiento-de-la-calidad.html"><a href="apuntes-de-control-y-aseguramiento-de-la-calidad.html#limites-reales-o-naturales"><i class="fa fa-check"></i><b>7.2.4</b> <strong>Límites reales o naturales</strong></a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="apuntes-de-control-y-aseguramiento-de-la-calidad.html"><a href="apuntes-de-control-y-aseguramiento-de-la-calidad.html#histograma-y-tabla-de-frecuencias"><i class="fa fa-check"></i><b>7.3</b> <strong>Histograma y tabla de frecuencias</strong></a><ul>
<li class="chapter" data-level="7.3.1" data-path="apuntes-de-control-y-aseguramiento-de-la-calidad.html"><a href="apuntes-de-control-y-aseguramiento-de-la-calidad.html#tabla-de-frecuencias"><i class="fa fa-check"></i><b>7.3.1</b> <strong>Tabla de frecuencias</strong></a></li>
<li class="chapter" data-level="7.3.2" data-path="apuntes-de-control-y-aseguramiento-de-la-calidad.html"><a href="apuntes-de-control-y-aseguramiento-de-la-calidad.html#histograma"><i class="fa fa-check"></i><b>7.3.2</b> <strong>Histograma</strong></a></li>
<li class="chapter" data-level="7.3.3" data-path="apuntes-de-control-y-aseguramiento-de-la-calidad.html"><a href="apuntes-de-control-y-aseguramiento-de-la-calidad.html#limitaciones-del-histograma"><i class="fa fa-check"></i><b>7.3.3</b> <strong>Limitaciones del histograma</strong></a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="apuntes-de-control-y-aseguramiento-de-la-calidad.html"><a href="apuntes-de-control-y-aseguramiento-de-la-calidad.html#medidas-de-forma"><i class="fa fa-check"></i><b>7.4</b> <strong>Medidas de forma</strong></a><ul>
<li class="chapter" data-level="7.4.1" data-path="apuntes-de-control-y-aseguramiento-de-la-calidad.html"><a href="apuntes-de-control-y-aseguramiento-de-la-calidad.html#sesgo"><i class="fa fa-check"></i><b>7.4.1</b> <strong>Sesgo</strong></a></li>
<li class="chapter" data-level="7.4.2" data-path="apuntes-de-control-y-aseguramiento-de-la-calidad.html"><a href="apuntes-de-control-y-aseguramiento-de-la-calidad.html#curtosis"><i class="fa fa-check"></i><b>7.4.2</b> <strong>Curtosis</strong></a></li>
<li class="chapter" data-level="7.4.3" data-path="apuntes-de-control-y-aseguramiento-de-la-calidad.html"><a href="apuntes-de-control-y-aseguramiento-de-la-calidad.html#cuantiles-percentiles"><i class="fa fa-check"></i><b>7.4.3</b> <strong>Cuantiles (percentiles)</strong></a></li>
<li class="chapter" data-level="7.4.4" data-path="apuntes-de-control-y-aseguramiento-de-la-calidad.html"><a href="apuntes-de-control-y-aseguramiento-de-la-calidad.html#cuartiles"><i class="fa fa-check"></i><b>7.4.4</b> <strong>Cuartiles</strong></a></li>
<li class="chapter" data-level="7.4.5" data-path="apuntes-de-control-y-aseguramiento-de-la-calidad.html"><a href="apuntes-de-control-y-aseguramiento-de-la-calidad.html#diagrama-de-caja"><i class="fa fa-check"></i><b>7.4.5</b> <strong>Diagrama de caja</strong></a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="apuntes-de-control-y-aseguramiento-de-la-calidad.html"><a href="apuntes-de-control-y-aseguramiento-de-la-calidad.html#conceptos-de-probabilidad"><i class="fa fa-check"></i><b>7.5</b> <strong>Conceptos de probabilidad</strong></a></li>
<li class="chapter" data-level="7.6" data-path="apuntes-de-control-y-aseguramiento-de-la-calidad.html"><a href="apuntes-de-control-y-aseguramiento-de-la-calidad.html#interpretacion-de-la-probabilidad"><i class="fa fa-check"></i><b>7.6</b> <strong>Interpretación de la probabilidad</strong></a></li>
</ul></li>
<li class="part"><span><b>IV Proyectos</b></span></li>
<li class="chapter" data-level="8" data-path="bayesian-cps.html"><a href="bayesian-cps.html"><i class="fa fa-check"></i><b>8</b> Bayesian Cps</a><ul>
<li class="chapter" data-level="8.1" data-path="bayesian-cps.html"><a href="bayesian-cps.html#introduccion-al-pensamiento-bayesiano"><i class="fa fa-check"></i><b>8.1</b> <strong>1. Introducción al pensamiento Bayesiano</strong></a></li>
<li class="chapter" data-level="8.2" data-path="bayesian-cps.html"><a href="bayesian-cps.html#repaso"><i class="fa fa-check"></i><b>8.2</b> <strong>2. Repaso</strong></a></li>
<li class="chapter" data-level="8.3" data-path="bayesian-cps.html"><a href="bayesian-cps.html#definiciones-y-notaciones"><i class="fa fa-check"></i><b>8.3</b> <strong>3. Definiciones y notaciones</strong></a></li>
<li class="chapter" data-level="8.4" data-path="bayesian-cps.html"><a href="bayesian-cps.html#la-distribucion-posterior-del-indice-de-capacidad-de-proceso-inferior"><i class="fa fa-check"></i><b>8.4</b> <strong>4. La distribución posterior del índice de capacidad de proceso inferior</strong></a><ul>
<li class="chapter" data-level="8.4.1" data-path="bayesian-cps.html"><a href="bayesian-cps.html#codigo-en-r__"><i class="fa fa-check"></i><b>8.4.1</b> __4.1 **Codigo en R__</a></li>
</ul></li>
<li class="chapter" data-level="8.5" data-path="bayesian-cps.html"><a href="bayesian-cps.html#distribucion-posterior-de-c_pkminc_plc_pu"><i class="fa fa-check"></i><b>8.5</b> <strong>5. Distribución posterior de:</strong> <span class="math inline">\(C_{pk}=min(C_{pl},C_{pu})\)</span></a></li>
<li class="chapter" data-level="8.6" data-path="bayesian-cps.html"><a href="bayesian-cps.html#ejemplo"><i class="fa fa-check"></i><b>8.6</b> <strong>6. Ejemplo </strong></a></li>
<li class="chapter" data-level="8.7" data-path="bayesian-cps.html"><a href="bayesian-cps.html#intervalos-de-confianza"><i class="fa fa-check"></i><b>8.7</b> <strong>7. Intervalos de confianza</strong></a></li>
<li class="chapter" data-level="8.8" data-path="bayesian-cps.html"><a href="bayesian-cps.html#distribucion-posterior-dec_pl-y-c_pu"><i class="fa fa-check"></i><b>8.8</b> <strong>8. Distribución posterior de:</strong><span class="math inline">\(C_{pl}\)</span> y <span class="math inline">\(C_{pu}\)</span></a><ul>
<li class="chapter" data-level="8.8.1" data-path="bayesian-cps.html"><a href="bayesian-cps.html#codigo-en-r__-1"><i class="fa fa-check"></i><b>8.8.1</b> __8.1 **Codigo en R__</a></li>
</ul></li>
<li class="chapter" data-level="8.9" data-path="bayesian-cps.html"><a href="bayesian-cps.html#conclusiones"><i class="fa fa-check"></i><b>8.9</b> <strong>9. Conclusiones</strong></a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="control-no-parametrico.html"><a href="control-no-parametrico.html"><i class="fa fa-check"></i><b>9</b> Control no Parametrico</a><ul>
<li class="chapter" data-level="9.1" data-path="control-no-parametrico.html"><a href="control-no-parametrico.html#control-no-parametricos"><i class="fa fa-check"></i><b>9.1</b> Control No Paramétricos</a></li>
<li class="chapter" data-level="9.2" data-path="control-no-parametrico.html"><a href="control-no-parametrico.html#test-de-rango-cuadrado-conover"><i class="fa fa-check"></i><b>9.2</b> Test de Rango Cuadrado “Conover”</a></li>
<li class="chapter" data-level="9.3" data-path="control-no-parametrico.html"><a href="control-no-parametrico.html#metodo"><i class="fa fa-check"></i><b>9.3</b> Método</a></li>
<li class="chapter" data-level="9.4" data-path="control-no-parametrico.html"><a href="control-no-parametrico.html#implementacion-en-r"><i class="fa fa-check"></i><b>9.4</b> Implementación en R</a></li>
<li class="chapter" data-level="9.5" data-path="control-no-parametrico.html"><a href="control-no-parametrico.html#estadistico-t-de-conover"><i class="fa fa-check"></i><b>9.5</b> Estadístico T de Conover</a></li>
<li class="chapter" data-level="9.6" data-path="control-no-parametrico.html"><a href="control-no-parametrico.html#histograma-de-t-bootstrap"><i class="fa fa-check"></i><b>9.6</b> Histograma de T (Bootstrap)</a></li>
<li class="chapter" data-level="9.7" data-path="control-no-parametrico.html"><a href="control-no-parametrico.html#histograma-de-t-bootstrap-1"><i class="fa fa-check"></i><b>9.7</b> Histograma de T (Bootstrap)</a></li>
<li class="chapter" data-level="9.8" data-path="control-no-parametrico.html"><a href="control-no-parametrico.html#graficos-de-control-2"><i class="fa fa-check"></i><b>9.8</b> Gráficos de Control</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="test-de-mood.html"><a href="test-de-mood.html"><i class="fa fa-check"></i><b>10</b> <strong>Test de Mood</strong></a><ul>
<li class="chapter" data-level="10.1" data-path="test-de-mood.html"><a href="test-de-mood.html#test-de-mood-para-la-dispersion"><i class="fa fa-check"></i><b>10.1</b> Test de Mood para la dispersión</a></li>
<li class="chapter" data-level="10.2" data-path="test-de-mood.html"><a href="test-de-mood.html#graficos-de-control-3"><i class="fa fa-check"></i><b>10.2</b> Gráficos de control</a></li>
<li class="chapter" data-level="10.3" data-path="test-de-mood.html"><a href="test-de-mood.html#simulacion"><i class="fa fa-check"></i><b>10.3</b> Simulación</a></li>
<li class="chapter" data-level="10.4" data-path="test-de-mood.html"><a href="test-de-mood.html#desempeno-del-grafico-de-controlarl"><i class="fa fa-check"></i><b>10.4</b> DESEMPEñO DEL GRáFICO DE CONTROL(ARL)</a></li>
<li class="chapter" data-level="10.5" data-path="test-de-mood.html"><a href="test-de-mood.html#cpmchange-point-model"><i class="fa fa-check"></i><b>10.5</b> CPM(Change Point Model)</a></li>
<li class="chapter" data-level="10.6" data-path="test-de-mood.html"><a href="test-de-mood.html#conclusiones-1"><i class="fa fa-check"></i><b>10.6</b> Conclusiones</a></li>
<li class="chapter" data-level="10.7" data-path="test-de-mood.html"><a href="test-de-mood.html#referencias"><i class="fa fa-check"></i><b>10.7</b> Referencias</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Control Estadístico de la Calidad</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="bayesian-cps" class="section level1">
<h1><span class="header-section-number">Capítulo 8</span> Bayesian Cps</h1>
<p><strong>author: “Sebastián Guerra y Estéfano Viteri”</strong></p>
<p><strong>date: “25 de enero de 2019”</strong></p>
<div id="introduccion-al-pensamiento-bayesiano" class="section level2">
<h2><span class="header-section-number">8.1</span> <strong>1. Introducción al pensamiento Bayesiano</strong></h2>
<div class="text-justify">
<p>La metodología bayesiana consta de tres pasos fundamentales:<br />
1. Especificar un modelo de probabilidad que incluya algún tipo de conocimiento previo (a priori) sobre los parámetros del modelo dado.<br />
2. Actualizar el conocimiento sobre los parámetros desconocidos condicionando este modelo de probabilidad a los datos observados.<br />
3. Evaluar el ajuste del modelo a los datos y la sensibilidad de las conclusiones a cambios en los supuestos del modelo.</p>
<p>La diferencia fundamental entre la estadística clásica (frecuentista) y la bayesiana es el concepto de probabilidad. Para la estadística clásica es un concepto objetivo, que se encuentra en la naturaleza, mientras que para la estadística bayesiana se encuentra en el observador, siendo así un concepto subjetivo. De este modo, en estadística clásica sólo se toma como fuente de información las muestras obtenidas suponiendo, para los desarrollos matemáticos, que se pueden tomar tamaños límite de las mismas. En el caso bayesiano, sin embargo, además de la muestra también juega un papel fundamental la información previa o externa que se posee en relación a los fenómenos que se tratan de modelizar.</p>
</div>
</div>
<div id="repaso" class="section level2">
<h2><span class="header-section-number">8.2</span> <strong>2. Repaso</strong></h2>
<p>El concepto básico en el que se basa la estadística bayesiana es el de <strong>probabilidad condicional</strong>:</p>
<p>Para dos eventos A y B,
<span class="math display">\[\begin{equation}
P\left ( A\mid B \right )=\frac{P\left ( A\cap B \right )}{P\left ( B \right )}\propto P\left ( A\cap B \right )
\end{equation}\]</span></p>
<p>Esta definición se puede aplicar a variables continuas o distcretas.
Desde el punto de vista bayesiano debemos toma ren cuenta q todas las probabilidades son condicionadas, es decir, se conoce algo sobre los eventos.</p>
<p><strong>Ley de la Probabilidad Total</strong><br />
Para un evento A y una partición <span class="math inline">\(B_{1},\ldots,B_{k}\)</span> tal que <span class="math inline">\(\bigcup_{i=1}^{n}B_{i}=\Omega\)</span> se tiene,</p>
<p><span class="math display">\[\begin{equation}
 P\left ( A \right )=\sum_{i=1}^{k}P\left ( A\mid B_{i} \right )P\left ( B_{i} \right )
\end{equation}\]</span></p>
<p>Ahora aplicando esta ley para variables discretas:
<span class="math display">\[\begin{equation}
f\left ( x \right )= \sum_{y}f\left ( x\mid Y=y \right )P\left ( Y=y \right )
\end{equation}\]</span></p>
<p>y variables continuas:</p>
<p><span class="math display">\[\begin{equation}

f\left ( x \right )= \int f\left ( x\mid y \right )f\left ( y \right )dy
\end{equation}\]</span></p>
<p><strong>El teorema de Bayes</strong></p>
<p>Dados eventos <span class="math inline">\(A_1, \ldots , A_n\)</span> y <span class="math inline">\(B\)</span>,</p>
<p><span class="math display">\[\begin{equation}
P\left ( A_{i}\mid B \right )=\frac{P\left ( B\mid A_{i} \right )P\left ( A_{i} \right )}{P\left ( B \right )}= \frac{P\left ( B\mid A_{i} \right )P\left ( A_{i} \right )}{\sum_{i=1}^{n}P\left ( B\mid A_{i} \right )P\left ( A_{i} \right )}\propto P\left ( B\mid A_{i} \right )P\left ( A_{i} \right )
\end{equation}\]</span></p>
<p>en el caso de que <span class="math inline">\(X\)</span> sea variable continua con <span class="math inline">\(f\)</span> función de distribución tenemos:</p>
<p><span class="math display">\[ 
f\left ( x\mid y\right )=\frac{f\left ( y\mid x \right )f\left ( x\right )}{f\left ( y\right )}=\frac{f\left ( y\mid x\right ) f\left ( x\right )}{\int_{\mathbb{R}} f\left ( y\mid x\right )f\left ( x\right )dx} \propto f\left( y\mid x \right) f \left( x \right)
\]</span></p>
<p><strong>Media y varianza condicionales</strong>
Dadas dos variables <span class="math inline">\(X\)</span> e <span class="math inline">\(Y\)</span> , definimos la media y varianza de <span class="math inline">\(X\)</span> cuando <span class="math inline">\(Y = y\)</span> como:</p>
<p><span class="math display">\[\begin{equation}
E\left [ X\mid Y=y\right ]=\int x f\left ( x\mid y \right ) dx
\end{equation}\]</span></p>
<p><span class="math display">\[\begin{equation}
Var\left [ X\mid Y=y \right ]=\int \left ( x-E\left [ X\mid Y=y\right ] \right )^{2} f\left ( x\mid y \right )
\end{equation}\]</span></p>
<p><strong>Teorema</strong><br />
Dadas dos variables <span class="math inline">\(X\)</span> e <span class="math inline">\(Y\)</span>, se tiene que:<br />
(<span class="math inline">\(i\)</span>) <span class="math inline">\(E_{x}\left [ X \right ]=E_{y}\left [ E_{x}\left [ X\mid Y \right ] \right ]\)</span></p>
<p>(<span class="math inline">\(ii\)</span>) <span class="math inline">\(Var_{x}\left [ X \right ]=E_{y}\left [ Var_{x}\left [ X\mid Y \right ] \right ]+ Var_{y}\left [ E_{x}\left [ X\mid Y \right ] \right ]\)</span></p>
</div>
<div id="definiciones-y-notaciones" class="section level2">
<h2><span class="header-section-number">8.3</span> <strong>3. Definiciones y notaciones</strong></h2>
<p>Los índices de capacidad que se analizaran son:
<span class="math display">\[\begin{equation}
C_{p}=\frac{u-l}{6\sigma}
\end{equation}\]</span></p>
<p><span class="math display">\[\begin{equation}
C_{pu}=\frac{u-\mu}{3\sigma}
\end{equation}\]</span></p>
<p><span class="math display">\[\begin{equation}
C_{pl}=\frac{\mu-l}{3\sigma}
\end{equation}\]</span></p>
<p>y</p>
<p><span class="math display">\[\begin{equation}
C_{pk}=\min \left ( C_{pu},C_{pl} \right )
\end{equation}\]</span></p>
<p>donde <span class="math inline">\(\mu\)</span> es la media poblacional, <span class="math inline">\(\sigma\)</span> es la desviación estandar poblacional, <span class="math inline">\(u\)</span> es el límite superior de especificación y <span class="math inline">\(l\)</span> es el límite inferior de especificación.</p>
<p>Sea <span class="math inline">\(y_1,y_2,\ldots,y_n\)</span> una muestra independiente de un proceso de fabricación. En este trabajo se asumirá que <span class="math inline">\(y_i\)</span> <span class="math inline">\((i=1,2,\ldots,n)\)</span> son variables aleatorias <strong>independientes</strong> e <strong>idénticamente distribuidas</strong> según una distribucion <strong>normal</strong> con media <span class="math inline">\(\mu\)</span> y varianza <span class="math inline">\(\sigma^{2}\)</span> .</p>
<p>Dado que <span class="math inline">\(\mu\)</span> y <span class="math inline">\(\sigma^{2}\)</span> son desconocidas y no existe información previa disponible, por ello se usa la distribución previa no informativa, Jeffreys’ prior (es invariante bajo una reparametrización)
<span class="math display">\[\begin{equation}
p(\mu.\sigma{2})\propto\sigma{-2}
\end{equation}\]</span>
será definida para <span class="math inline">\(\mu\)</span> y <span class="math inline">\(\sigma\)</span>.</p>
</div>
<div id="la-distribucion-posterior-del-indice-de-capacidad-de-proceso-inferior" class="section level2">
<h2><span class="header-section-number">8.4</span> <strong>4. La distribución posterior del índice de capacidad de proceso inferior</strong></h2>
<p><span class="math inline">\(C_{pl}=\frac{\mu-l}{3\sigma}\)</span>.</p>
<p>Notemos que <span class="math display">\[C_{pl}=\frac{\mu-l}{3\sigma}\]</span></p>
<p><strong>Teorema</strong>
La distribución posterior de <span class="math inline">\(t=C_{pl}\)</span> esta dada por</p>
<p><span class="math display">\[
p\left ( t\mid \hat{t} \right )=\frac{3\sqrt{n} exp(-\frac{9nt^2}{2})}{\Gamma{\frac{v}{2}}\sqrt{2\pi}}\sum_{j=1}^{\infty}\left(\frac{9nt\hat{t}}{\sqrt{v}}\right)^j \frac{1}{j!} \frac{\Gamma{\frac{v+j}{2}}2^{\frac{j}{2}}}{(1+\frac{9n\hat{t}^2}{v})^\frac{v+j}{2}}
\]</span></p>
<p>Donde</p>
<p><span class="math display">\[\hat{t}=\frac{\bar{y}-l}{3s}=\hat{C_{pl}} \]</span>
Y
<span class="math display">\[v=n-1 \]</span></p>
<div id="codigo-en-r__" class="section level3">
<h3><span class="header-section-number">8.4.1</span> __4.1 **Codigo en R__</h3>
<div class="sourceCode" id="cb616"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb616-1" title="1">posterior_di&lt;-<span class="cf">function</span>(inf,y,l,s,n,t){</a>
<a class="sourceLine" id="cb616-2" title="2">  t_techo&lt;-(y<span class="op">-</span>l)<span class="op">/</span>(<span class="dv">3</span><span class="op">*</span>s)</a>
<a class="sourceLine" id="cb616-3" title="3">  v&lt;-n<span class="dv">-1</span></a>
<a class="sourceLine" id="cb616-4" title="4">  c&lt;-(<span class="dv">3</span><span class="op">*</span><span class="kw">sqrt</span>(n)<span class="op">*</span><span class="kw">exp</span>((<span class="op">-</span><span class="dv">9</span><span class="op">*</span>n<span class="op">*</span>(t<span class="op">^</span><span class="dv">2</span>))<span class="op">/</span><span class="dv">2</span>))<span class="op">/</span>(<span class="kw">gamma</span>(v<span class="op">/</span><span class="dv">2</span>)<span class="op">*</span><span class="kw">sqrt</span>(<span class="dv">2</span><span class="op">*</span>pi))</a>
<a class="sourceLine" id="cb616-5" title="5">  g&lt;-<span class="dv">0</span></a>
<a class="sourceLine" id="cb616-6" title="6">  <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">0</span><span class="op">:</span>inf) {</a>
<a class="sourceLine" id="cb616-7" title="7">    g &lt;-<span class="st"> </span>g<span class="op">+</span>(((<span class="dv">9</span><span class="op">*</span>n<span class="op">*</span>t<span class="op">*</span>t_techo)<span class="op">/</span><span class="kw">sqrt</span>(v))<span class="op">^</span>j)<span class="op">*</span>(<span class="dv">1</span><span class="op">/</span><span class="kw">factorial1</span>(j))<span class="op">*</span>((<span class="kw">gamma</span>((v<span class="op">+</span>j)<span class="op">/</span><span class="dv">2</span>)<span class="op">*</span>(<span class="dv">2</span><span class="op">^</span>(j<span class="op">/</span><span class="dv">2</span>)))<span class="op">/</span>(<span class="dv">1</span><span class="op">+</span>((<span class="dv">9</span><span class="op">*</span>n<span class="op">*</span>(t_techo<span class="op">^</span><span class="dv">2</span>))<span class="op">/</span>v))<span class="op">^</span>((v<span class="op">+</span>j)<span class="op">/</span><span class="dv">2</span>))</a>
<a class="sourceLine" id="cb616-8" title="8">  }</a>
<a class="sourceLine" id="cb616-9" title="9">  <span class="kw">return</span>(c<span class="op">*</span>g)</a>
<a class="sourceLine" id="cb616-10" title="10">}</a></code></pre></div>
</div>
</div>
<div id="distribucion-posterior-de-c_pkminc_plc_pu" class="section level2">
<h2><span class="header-section-number">8.5</span> <strong>5. Distribución posterior de:</strong> <span class="math inline">\(C_{pk}=min(C_{pl},C_{pu})\)</span></h2>
<p>Cuando se tienen especificados los limites, el <span class="math inline">\(C_{p}\)</span> y <span class="math inline">\(C_{pk}\)</span> son usados
<span class="math display">\[C_{pk}=min(C_{pl},C_{pu})\]</span>
<strong>Teorema</strong>
La distribución posterior de <span class="math inline">\(c=C_{pk}\)</span> esta dada por</p>
<p><span class="math display">\[
p\left ( c\mid \ y\right )=\frac{3\sqrt{n}}{\sqrt{2\pi}}\int_{\frac{c^2v}{\hat{b}^2}}^{\infty} \left\lbrace exp \left(-\frac{9n}{2} \left[c-t^*\sqrt{\frac{k}{v}} \right]^2 \right)+exp \left(-\frac{9n}{2} \left[c-\hat{t}\sqrt{\frac{k}{v}} \right]^2 \right) \right\rbrace \frac{1}{2^{\frac{v}{2}}\Gamma{\left(\frac{v}{2}\right)}} k^{\frac{v}{2}-1} exp \left(-\frac{k}{2} \right) dk
\]</span></p>
<p>Donde</p>
<p><span class="math display">\[v=n-1 \]</span>
<span class="math display">\[t^*=\hat{C_{pu}}=\frac{u-\bar{y}}{3s}\]</span>
<span class="math display">\[\hat{t}=\hat{C_{pl}}=\frac{\bar{y}-l}{3s}\]</span>
Finalmente</p>
<p><span class="math display">\[\hat{b}=\hat{C_{p}}=\frac{u-l}{6s}\]</span></p>
<div class="sourceCode" id="cb617"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb617-1" title="1"><span class="co">#### Distribucion posterior del CPK</span></a>
<a class="sourceLine" id="cb617-2" title="2"><span class="co">#### distribucion posterior del CPK</span></a>
<a class="sourceLine" id="cb617-3" title="3">Supplier &lt;-<span class="st"> </span><span class="cf">function</span>(Cpk,sample,media,desv) {</a>
<a class="sourceLine" id="cb617-4" title="4">n &lt;-<span class="st"> </span>sample</a>
<a class="sourceLine" id="cb617-5" title="5">v &lt;-<span class="st"> </span>n<span class="dv">-1</span></a>
<a class="sourceLine" id="cb617-6" title="6">u &lt;-<span class="st"> </span><span class="fl">2.7205</span></a>
<a class="sourceLine" id="cb617-7" title="7">s &lt;-<span class="st"> </span>desv</a>
<a class="sourceLine" id="cb617-8" title="8">l &lt;-<span class="st"> </span><span class="fl">2.6795</span></a>
<a class="sourceLine" id="cb617-9" title="9">ybarra &lt;-<span class="st"> </span>media</a>
<a class="sourceLine" id="cb617-10" title="10">t1 &lt;-<span class="st"> </span>(u<span class="op">-</span>ybarra)<span class="op">/</span>(<span class="dv">3</span><span class="op">*</span>s)</a>
<a class="sourceLine" id="cb617-11" title="11">t2 &lt;-<span class="st"> </span>(ybarra<span class="op">-</span>l)<span class="op">/</span>(<span class="dv">3</span><span class="op">*</span>s)</a>
<a class="sourceLine" id="cb617-12" title="12">b1 &lt;-<span class="st"> </span>(u<span class="op">-</span>l)<span class="op">/</span>(<span class="dv">6</span><span class="op">*</span>s)</a>
<a class="sourceLine" id="cb617-13" title="13">cte &lt;-<span class="st"> </span>((<span class="dv">3</span><span class="op">*</span><span class="kw">sqrt</span>(n))<span class="op">/</span>(<span class="kw">sqrt</span>(<span class="dv">2</span><span class="op">*</span>pi)))</a>
<a class="sourceLine" id="cb617-14" title="14">a &lt;-<span class="st"> </span>((Cpk<span class="op">^</span><span class="dv">2</span>)<span class="op">*</span>v)<span class="op">/</span>((b1)<span class="op">^</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb617-15" title="15">b &lt;-<span class="st"> </span><span class="ot">Inf</span></a>
<a class="sourceLine" id="cb617-16" title="16">P &lt;-<span class="st"> </span><span class="cf">function</span>(k){(<span class="kw">exp</span>((<span class="op">-</span>(<span class="dv">9</span><span class="op">*</span>n)<span class="op">/</span><span class="dv">2</span>)<span class="op">*</span>(Cpk<span class="op">-</span>t1<span class="op">*</span>(<span class="kw">sqrt</span>(k<span class="op">/</span>v)))<span class="op">^</span><span class="dv">2</span>)<span class="op">+</span><span class="kw">exp</span>((<span class="op">-</span>(<span class="dv">9</span><span class="op">*</span>n)<span class="op">/</span><span class="dv">2</span>)<span class="op">*</span>(Cpk<span class="op">-</span>t2<span class="op">*</span>(<span class="kw">sqrt</span>(k<span class="op">/</span>v)))<span class="op">^</span><span class="dv">2</span>))<span class="op">*</span>(<span class="dv">1</span><span class="op">/</span>((<span class="dv">2</span><span class="op">^</span>(v<span class="op">/</span><span class="dv">2</span>))<span class="op">*</span><span class="kw">gamma</span>(v<span class="op">/</span><span class="dv">2</span>)))<span class="op">*</span>(k<span class="op">^</span>((v<span class="op">/</span><span class="dv">2</span>)<span class="op">-</span><span class="dv">1</span>))<span class="op">*</span><span class="kw">exp</span>(<span class="op">-</span>k<span class="op">/</span><span class="dv">2</span>)}</a>
<a class="sourceLine" id="cb617-17" title="17">Q &lt;-<span class="st"> </span><span class="kw">integrate</span>(<span class="dt">f =</span> <span class="kw">Vectorize</span>(P),<span class="dt">lower =</span> a,<span class="dt">upper =</span> b)</a>
<a class="sourceLine" id="cb617-18" title="18"><span class="kw">return</span>(cte<span class="op">*</span>(Q<span class="op">$</span>value))</a>
<a class="sourceLine" id="cb617-19" title="19">}</a></code></pre></div>
</div>
<div id="ejemplo" class="section level2">
<h2><span class="header-section-number">8.6</span> <strong>6. Ejemplo </strong></h2>
<div class="sourceCode" id="cb618"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb618-1" title="1"><span class="co">####VALORES INICIALES</span></a>
<a class="sourceLine" id="cb618-2" title="2">sample &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">50</span>,<span class="dv">75</span>,<span class="dv">70</span>,<span class="dv">75</span>)</a>
<a class="sourceLine" id="cb618-3" title="3">medias &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">2.7048</span>,<span class="fl">2.7019</span>,<span class="fl">2.6979</span>,<span class="fl">2.6972</span>)</a>
<a class="sourceLine" id="cb618-4" title="4">desviaciones &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">0.0034</span>,<span class="fl">0.0055</span>,<span class="fl">0.0046</span>,<span class="fl">0.0038</span>)</a>
<a class="sourceLine" id="cb618-5" title="5">esp &lt;-<span class="st"> </span><span class="kw">c</span>( <span class="fl">2.7205</span>,<span class="fl">2.6795</span>)</a>
<a class="sourceLine" id="cb618-6" title="6"></a>
<a class="sourceLine" id="cb618-7" title="7"><span class="co">#Función a integrar</span></a>
<a class="sourceLine" id="cb618-8" title="8">J &lt;-<span class="st"> </span><span class="cf">function</span>(k,n,v,Cpk,t1,t2) {(<span class="kw">exp</span>((<span class="op">-</span>(<span class="dv">9</span><span class="op">*</span>n)<span class="op">/</span><span class="dv">2</span>)<span class="op">*</span>(Cpk<span class="op">-</span>t1<span class="op">*</span>(<span class="kw">sqrt</span>(k<span class="op">/</span>v)))<span class="op">^</span><span class="dv">2</span>)<span class="op">+</span><span class="kw">exp</span>((<span class="op">-</span>(<span class="dv">9</span><span class="op">*</span>n)<span class="op">/</span><span class="dv">2</span>)<span class="op">*</span>(Cpk<span class="op">-</span>t2<span class="op">*</span>(<span class="kw">sqrt</span>(k<span class="op">/</span>v)))<span class="op">^</span><span class="dv">2</span>))<span class="op">*</span>(<span class="dv">1</span><span class="op">/</span>((<span class="dv">2</span><span class="op">^</span>(v<span class="op">/</span><span class="dv">2</span>))<span class="op">*</span><span class="kw">gamma</span>(v<span class="op">/</span><span class="dv">2</span>)))<span class="op">*</span>(k<span class="op">^</span>((v<span class="op">/</span><span class="dv">2</span>)<span class="op">-</span><span class="dv">1</span>))<span class="op">*</span><span class="kw">exp</span>(<span class="op">-</span>k<span class="op">/</span><span class="dv">2</span>)}</a>
<a class="sourceLine" id="cb618-9" title="9"></a>
<a class="sourceLine" id="cb618-10" title="10"></a>
<a class="sourceLine" id="cb618-11" title="11"></a>
<a class="sourceLine" id="cb618-12" title="12">grafico &lt;-<span class="st"> </span><span class="cf">function</span>(x)</a>
<a class="sourceLine" id="cb618-13" title="13">{</a>
<a class="sourceLine" id="cb618-14" title="14">  <span class="kw">return</span>(<span class="kw">Supplier</span>(<span class="dt">Cpk =</span> x,<span class="dt">sample =</span> sample[<span class="dv">1</span>],<span class="dt">media =</span> medias[<span class="dv">1</span>],<span class="dt">desv =</span> desviaciones[<span class="dv">1</span>]))</a>
<a class="sourceLine" id="cb618-15" title="15">}</a>
<a class="sourceLine" id="cb618-16" title="16">grafico1 &lt;-<span class="st"> </span><span class="cf">function</span>(x)</a>
<a class="sourceLine" id="cb618-17" title="17">{</a>
<a class="sourceLine" id="cb618-18" title="18">  <span class="kw">return</span>(<span class="kw">Supplier</span>(<span class="dt">Cpk =</span> x,<span class="dt">sample =</span> sample[<span class="dv">2</span>],<span class="dt">media =</span> medias[<span class="dv">2</span>],<span class="dt">desv =</span> desviaciones[<span class="dv">2</span>]))</a>
<a class="sourceLine" id="cb618-19" title="19">}</a>
<a class="sourceLine" id="cb618-20" title="20">grafico2 &lt;-<span class="st"> </span><span class="cf">function</span>(x)</a>
<a class="sourceLine" id="cb618-21" title="21">{</a>
<a class="sourceLine" id="cb618-22" title="22">  <span class="kw">return</span>(<span class="kw">Supplier</span>(<span class="dt">Cpk =</span> x,<span class="dt">sample =</span> sample[<span class="dv">3</span>],<span class="dt">media =</span>medias[<span class="dv">3</span>],<span class="dt">desv =</span> desviaciones[<span class="dv">3</span>]))</a>
<a class="sourceLine" id="cb618-23" title="23">}</a>
<a class="sourceLine" id="cb618-24" title="24">grafico3 &lt;-<span class="st"> </span><span class="cf">function</span>(x)</a>
<a class="sourceLine" id="cb618-25" title="25">{</a>
<a class="sourceLine" id="cb618-26" title="26">  <span class="kw">return</span>(<span class="kw">Supplier</span>(<span class="dt">Cpk =</span> x,<span class="dt">sample =</span> sample[<span class="dv">4</span>],<span class="dt">media =</span> medias[<span class="dv">4</span>],<span class="dt">desv =</span> desviaciones[<span class="dv">4</span>]))</a>
<a class="sourceLine" id="cb618-27" title="27">}</a>
<a class="sourceLine" id="cb618-28" title="28"></a>
<a class="sourceLine" id="cb618-29" title="29">k&lt;-<span class="dv">4</span> </a>
<a class="sourceLine" id="cb618-30" title="30"><span class="kw">plot</span>(<span class="kw">Vectorize</span>(grafico),<span class="dt">xlim=</span><span class="kw">c</span>(<span class="fl">0.5</span>,<span class="fl">2.5</span>),<span class="dt">ylim=</span><span class="kw">c</span>(<span class="dv">0</span>,k),<span class="dt">col=</span><span class="st">&quot;black&quot;</span>,<span class="dt">lwd=</span><span class="dv">2</span>,<span class="dt">main=</span> <span class="st">&quot;Distribuciòn Posterior del Cpk&quot;</span>,<span class="dt">xlab =</span> <span class="st">&quot;Cpk&quot;</span>)</a>
<a class="sourceLine" id="cb618-31" title="31"><span class="kw">plot</span>(<span class="kw">Vectorize</span>(grafico1),<span class="dt">xlim=</span><span class="kw">c</span>(<span class="fl">0.5</span>,<span class="fl">2.5</span>),<span class="dt">ylim=</span><span class="kw">c</span>(<span class="dv">0</span>,k),<span class="dt">add=</span><span class="ot">TRUE</span>,<span class="dt">col=</span><span class="st">&quot;red&quot;</span>,<span class="dt">lwd=</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb618-32" title="32"><span class="kw">plot</span>(<span class="kw">Vectorize</span>(grafico2),<span class="dt">xlim=</span><span class="kw">c</span>(<span class="fl">0.5</span>,<span class="fl">2.5</span>),<span class="dt">ylim=</span><span class="kw">c</span>(<span class="dv">0</span>,k),<span class="dt">add=</span><span class="ot">TRUE</span>,<span class="dt">col=</span><span class="st">&quot;blue&quot;</span>,<span class="dt">lwd=</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb618-33" title="33"><span class="kw">plot</span>(<span class="kw">Vectorize</span>(grafico3),<span class="dt">xlim=</span><span class="kw">c</span>(<span class="fl">0.5</span>,<span class="fl">2.5</span>),<span class="dt">ylim=</span><span class="kw">c</span>(<span class="dv">0</span>,k),<span class="dt">add=</span><span class="ot">TRUE</span>,<span class="dt">col=</span><span class="st">&quot;green&quot;</span>,<span class="dt">lwd=</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb618-34" title="34"><span class="kw">legend</span>(<span class="st">&quot;topright&quot;</span>,<span class="dt">col=</span><span class="kw">c</span>(<span class="st">&quot;black&quot;</span>,<span class="st">&quot;red&quot;</span>,<span class="st">&quot;blue&quot;</span>,<span class="st">&quot;green&quot;</span>),<span class="dt">legend =</span><span class="kw">c</span>(<span class="st">&quot;Supplier&quot;</span>,<span class="st">&quot;Supplier2&quot;</span>,<span class="st">&quot;Supplier3&quot;</span>,<span class="st">&quot;Supplier4&quot;</span>), <span class="dt">lwd=</span><span class="dv">3</span>, <span class="dt">bty =</span> <span class="st">&quot;n&quot;</span>)</a></code></pre></div>
<p><img src="control_book_files/figure-html/unnamed-chunk-206-1.png" width="672" /></p>
<p>Para encontrar la media y varianza posteriores se usará el método por Monte-Carlo y el método de Aceptación-Rechazo.</p>
<div class="sourceCode" id="cb619"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb619-1" title="1"><span class="co">#######GENERACION DE DATOS DE LA DISTRIBUCION POSTERIOR POR MEDIO DE ACEPTACION RECHAZO</span></a>
<a class="sourceLine" id="cb619-2" title="2"><span class="co">## Función que acota a las posteriores del Cpk</span></a>
<a class="sourceLine" id="cb619-3" title="3"></a>
<a class="sourceLine" id="cb619-4" title="4"><span class="kw">plot</span>(<span class="kw">Vectorize</span>(grafico),<span class="dt">xlim=</span><span class="kw">c</span>(<span class="fl">0.5</span>,<span class="fl">2.5</span>),<span class="dt">ylim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">6</span>),<span class="dt">col=</span><span class="st">&quot;black&quot;</span>,<span class="dt">lwd=</span><span class="dv">2</span>,<span class="dt">main=</span> <span class="st">&quot;Funciòn que acota al Cpk&quot;</span>,<span class="dt">xlab =</span> <span class="st">&quot;Cpk&quot;</span>)</a>
<a class="sourceLine" id="cb619-5" title="5"><span class="kw">plot</span>(<span class="kw">Vectorize</span>(grafico1),<span class="dt">xlim=</span><span class="kw">c</span>(<span class="fl">0.5</span>,<span class="fl">2.5</span>),<span class="dt">ylim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">6</span>),<span class="dt">add=</span><span class="ot">TRUE</span>,<span class="dt">col=</span><span class="st">&quot;red&quot;</span>,<span class="dt">lwd=</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb619-6" title="6"><span class="kw">plot</span>(<span class="kw">Vectorize</span>(grafico2),<span class="dt">xlim=</span><span class="kw">c</span>(<span class="fl">0.5</span>,<span class="fl">2.5</span>),<span class="dt">ylim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">6</span>),<span class="dt">add=</span><span class="ot">TRUE</span>,<span class="dt">col=</span><span class="st">&quot;blue&quot;</span>,<span class="dt">lwd=</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb619-7" title="7"><span class="kw">plot</span>(<span class="kw">Vectorize</span>(grafico3),<span class="dt">xlim=</span><span class="kw">c</span>(<span class="fl">0.5</span>,<span class="fl">2.5</span>),<span class="dt">ylim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">6</span>),<span class="dt">add=</span><span class="ot">TRUE</span>,<span class="dt">col=</span><span class="st">&quot;green&quot;</span>,<span class="dt">lwd=</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb619-8" title="8">grafico4 &lt;-<span class="st"> </span><span class="cf">function</span>(x)</a>
<a class="sourceLine" id="cb619-9" title="9">{</a>
<a class="sourceLine" id="cb619-10" title="10">  <span class="kw">return</span>(<span class="dv">4</span><span class="op">*</span><span class="kw">dnorm</span>(<span class="dt">x =</span> x,<span class="dt">mean =</span> <span class="fl">1.3</span>,<span class="dt">sd =</span> <span class="fl">0.3</span>))</a>
<a class="sourceLine" id="cb619-11" title="11">}</a>
<a class="sourceLine" id="cb619-12" title="12"><span class="kw">plot</span>(grafico4,<span class="dt">xlim=</span><span class="kw">c</span>(<span class="fl">0.5</span>,<span class="fl">2.5</span>),<span class="dt">ylim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">6</span>),<span class="dt">add=</span><span class="ot">TRUE</span>,<span class="dt">col=</span><span class="st">&quot;brown&quot;</span>,<span class="dt">lwd=</span><span class="dv">2</span>)</a></code></pre></div>
<p><img src="control_book_files/figure-html/AR-1.png" width="672" /></p>
<div class="sourceCode" id="cb620"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb620-1" title="1">aceptacion_rechazo &lt;-<span class="st"> </span><span class="cf">function</span>(T) {</a>
<a class="sourceLine" id="cb620-2" title="2">s &lt;-<span class="st"> </span><span class="kw">vector</span>()</a>
<a class="sourceLine" id="cb620-3" title="3">num &lt;-<span class="st"> </span><span class="dv">100</span> <span class="co">##numero de datos</span></a>
<a class="sourceLine" id="cb620-4" title="4">i&lt;-<span class="dv">1</span></a>
<a class="sourceLine" id="cb620-5" title="5"><span class="cf">while</span> (i<span class="op">&lt;=</span>num) {</a>
<a class="sourceLine" id="cb620-6" title="6">  Y &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="fl">1.3</span>,<span class="fl">0.3</span>)</a>
<a class="sourceLine" id="cb620-7" title="7">  U &lt;-<span class="st"> </span><span class="kw">runif</span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb620-8" title="8">  <span class="cf">if</span>(U <span class="op">&lt;=</span><span class="st"> </span>(<span class="kw">T</span>(Y)<span class="op">/</span>(<span class="dv">4</span><span class="op">*</span><span class="kw">dnorm</span>(<span class="dt">x =</span> Y,<span class="dt">mean =</span> <span class="fl">1.3</span>,<span class="dt">sd =</span> <span class="fl">0.3</span>))))</a>
<a class="sourceLine" id="cb620-9" title="9">  {</a>
<a class="sourceLine" id="cb620-10" title="10">    s[i]&lt;-Y</a>
<a class="sourceLine" id="cb620-11" title="11">    i &lt;-<span class="st"> </span>i<span class="op">+</span><span class="dv">1</span></a>
<a class="sourceLine" id="cb620-12" title="12">  }</a>
<a class="sourceLine" id="cb620-13" title="13">}</a>
<a class="sourceLine" id="cb620-14" title="14"><span class="kw">return</span> (s)</a>
<a class="sourceLine" id="cb620-15" title="15"></a>
<a class="sourceLine" id="cb620-16" title="16">}</a>
<a class="sourceLine" id="cb620-17" title="17"></a>
<a class="sourceLine" id="cb620-18" title="18"></a>
<a class="sourceLine" id="cb620-19" title="19">Proveedor_<span class="dv">1</span> &lt;-<span class="st"> </span><span class="kw">round</span>(<span class="kw">c</span>(<span class="kw">mean</span>(<span class="kw">aceptacion_rechazo</span>(grafico)),<span class="kw">sd</span>(<span class="kw">aceptacion_rechazo</span>(grafico))),<span class="dv">4</span>)</a>
<a class="sourceLine" id="cb620-20" title="20">Proveedor_<span class="dv">2</span> &lt;-<span class="st"> </span><span class="kw">round</span>(<span class="kw">c</span>(<span class="kw">mean</span>(<span class="kw">aceptacion_rechazo</span>(grafico1)),<span class="kw">sd</span>(<span class="kw">aceptacion_rechazo</span>(grafico1))),<span class="dv">4</span>)</a>
<a class="sourceLine" id="cb620-21" title="21">Proveedor_<span class="dv">3</span> &lt;-<span class="st"> </span><span class="kw">round</span>(<span class="kw">c</span>(<span class="kw">mean</span>(<span class="kw">aceptacion_rechazo</span>(grafico2)),<span class="kw">sd</span>(<span class="kw">aceptacion_rechazo</span>(grafico2))),<span class="dv">4</span>)</a>
<a class="sourceLine" id="cb620-22" title="22">Proveedor_<span class="dv">4</span> &lt;-<span class="st"> </span><span class="kw">round</span>(<span class="kw">c</span>(<span class="kw">mean</span>(<span class="kw">aceptacion_rechazo</span>(grafico3)),<span class="kw">sd</span>(<span class="kw">aceptacion_rechazo</span>(grafico3))),<span class="dv">4</span>)</a>
<a class="sourceLine" id="cb620-23" title="23"></a>
<a class="sourceLine" id="cb620-24" title="24">Generando_muestras &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">row.names =</span><span class="kw">c</span>(<span class="st">&quot;Media Posterior&quot;</span>,<span class="st">&quot;Varianza Posterior&quot;</span>),Proveedor_<span class="dv">1</span>,Proveedor_<span class="dv">2</span>,Proveedor_<span class="dv">3</span>,Proveedor_<span class="dv">4</span>)</a></code></pre></div>
<p><img src="control_book_files/figure-html/unnamed-chunk-207-1.png" width="672" /></p>
<div class="sourceCode" id="cb621"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb621-1" title="1"><span class="co">### MEDIA DE LA DISTRIBUCION POSTERIOR POR MONTECARLO</span></a>
<a class="sourceLine" id="cb621-2" title="2"></a>
<a class="sourceLine" id="cb621-3" title="3">media_posterior &lt;-<span class="st"> </span><span class="cf">function</span>(sample,media,desv) {</a>
<a class="sourceLine" id="cb621-4" title="4">  n &lt;-<span class="st"> </span>sample</a>
<a class="sourceLine" id="cb621-5" title="5">  v &lt;-<span class="st"> </span>n<span class="dv">-1</span></a>
<a class="sourceLine" id="cb621-6" title="6">  u &lt;-<span class="st"> </span><span class="fl">2.7205</span></a>
<a class="sourceLine" id="cb621-7" title="7">  s &lt;-<span class="st"> </span>desv</a>
<a class="sourceLine" id="cb621-8" title="8">  l &lt;-<span class="st"> </span><span class="fl">2.6795</span></a>
<a class="sourceLine" id="cb621-9" title="9">  ybarra &lt;-<span class="st"> </span>media</a>
<a class="sourceLine" id="cb621-10" title="10">  t1 &lt;-<span class="st"> </span>(u<span class="op">-</span>ybarra)<span class="op">/</span>(<span class="dv">3</span><span class="op">*</span>s)</a>
<a class="sourceLine" id="cb621-11" title="11">  t2 &lt;-<span class="st"> </span>(ybarra<span class="op">-</span>l)<span class="op">/</span>(<span class="dv">3</span><span class="op">*</span>s)</a>
<a class="sourceLine" id="cb621-12" title="12">  b1 &lt;-<span class="st"> </span>(u<span class="op">-</span>l)<span class="op">/</span>(<span class="dv">6</span><span class="op">*</span>s)</a>
<a class="sourceLine" id="cb621-13" title="13">  cte &lt;-<span class="st"> </span>((<span class="dv">3</span><span class="op">*</span><span class="kw">sqrt</span>(n))<span class="op">/</span>(<span class="kw">sqrt</span>(<span class="dv">2</span><span class="op">*</span>pi)))</a>
<a class="sourceLine" id="cb621-14" title="14">  N &lt;-<span class="st"> </span><span class="dv">1000000</span></a>
<a class="sourceLine" id="cb621-15" title="15">  M &lt;-<span class="st"> </span><span class="dv">20</span></a>
<a class="sourceLine" id="cb621-16" title="16">  x &lt;-<span class="st"> </span><span class="dv">0</span></a>
<a class="sourceLine" id="cb621-17" title="17">  y &lt;-<span class="st"> </span><span class="dv">0</span></a>
<a class="sourceLine" id="cb621-18" title="18">  c &lt;-<span class="st"> </span><span class="dv">-1000</span></a>
<a class="sourceLine" id="cb621-19" title="19">  d &lt;-<span class="st"> </span><span class="dv">1000</span></a>
<a class="sourceLine" id="cb621-20" title="20">  <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>M) {</a>
<a class="sourceLine" id="cb621-21" title="21">    Cpk &lt;-<span class="st"> </span><span class="kw">runif</span>(<span class="dv">1</span>)<span class="op">*</span>(d<span class="op">-</span>c)<span class="op">+</span>c</a>
<a class="sourceLine" id="cb621-22" title="22">    a &lt;-<span class="st"> </span>(Cpk<span class="op">^</span><span class="dv">2</span> <span class="op">*</span>v)<span class="op">/</span>(b1)<span class="op">^</span><span class="dv">2</span></a>
<a class="sourceLine" id="cb621-23" title="23">    b &lt;-<span class="st"> </span><span class="dv">10000</span></a>
<a class="sourceLine" id="cb621-24" title="24">    <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>N) {</a>
<a class="sourceLine" id="cb621-25" title="25">    k &lt;-<span class="st"> </span><span class="kw">runif</span>(<span class="dv">1</span>)<span class="op">*</span>(b<span class="op">-</span>a)<span class="op">+</span>a</a>
<a class="sourceLine" id="cb621-26" title="26">    x &lt;-<span class="st"> </span>x <span class="op">+</span>{(<span class="kw">exp</span>((<span class="op">-</span>(<span class="dv">9</span><span class="op">*</span>n)<span class="op">/</span><span class="dv">2</span>)<span class="op">*</span>(Cpk<span class="op">-</span>t1<span class="op">*</span>(<span class="kw">sqrt</span>(k<span class="op">/</span>v)))<span class="op">^</span><span class="dv">2</span>)<span class="op">+</span><span class="kw">exp</span>((<span class="op">-</span>(<span class="dv">9</span><span class="op">*</span>n)<span class="op">/</span><span class="dv">2</span>)<span class="op">*</span>(Cpk<span class="op">-</span>t2<span class="op">*</span>(<span class="kw">sqrt</span>(k<span class="op">/</span>v)))<span class="op">^</span><span class="dv">2</span>))<span class="op">*</span>(<span class="dv">1</span><span class="op">/</span>((<span class="dv">2</span><span class="op">^</span>(v<span class="op">/</span><span class="dv">2</span>))<span class="op">*</span><span class="kw">gamma</span>(v<span class="op">/</span><span class="dv">2</span>)))<span class="op">*</span>(k<span class="op">^</span>((v<span class="op">/</span><span class="dv">2</span>)<span class="op">-</span><span class="dv">1</span>))<span class="op">*</span><span class="kw">exp</span>(<span class="op">-</span>k<span class="op">/</span><span class="dv">2</span>)}</a>
<a class="sourceLine" id="cb621-27" title="27">    }</a>
<a class="sourceLine" id="cb621-28" title="28">    y &lt;-<span class="st"> </span>y <span class="op">+</span><span class="st"> </span>Cpk<span class="op">*</span>cte<span class="op">*</span>x</a>
<a class="sourceLine" id="cb621-29" title="29">  }</a>
<a class="sourceLine" id="cb621-30" title="30">  <span class="kw">return</span>(((d<span class="op">-</span>c)<span class="op">/</span>N)<span class="op">*</span>y)</a>
<a class="sourceLine" id="cb621-31" title="31">}</a>
<a class="sourceLine" id="cb621-32" title="32">  </a>
<a class="sourceLine" id="cb621-33" title="33"></a>
<a class="sourceLine" id="cb621-34" title="34">post_media_mc &lt;-<span class="st"> </span><span class="kw">vector</span>()</a>
<a class="sourceLine" id="cb621-35" title="35"></a>
<a class="sourceLine" id="cb621-36" title="36">post_media_mc [<span class="dv">1</span>] &lt;-<span class="st"> </span><span class="kw">media_posterior</span>(<span class="dt">sample =</span> sample[<span class="dv">1</span>],<span class="dt">media =</span> medias[<span class="dv">1</span>],<span class="dt">desv =</span> desviaciones[<span class="dv">1</span>])</a>
<a class="sourceLine" id="cb621-37" title="37">post_media_mc [<span class="dv">2</span>] &lt;-<span class="st"> </span><span class="kw">media_posterior</span>(<span class="dt">sample =</span> sample[<span class="dv">2</span>],<span class="dt">media =</span> medias[<span class="dv">2</span>],<span class="dt">desv =</span> desviaciones[<span class="dv">2</span>])</a>
<a class="sourceLine" id="cb621-38" title="38">post_media_mc [<span class="dv">3</span>] &lt;-<span class="st"> </span><span class="kw">media_posterior</span>(<span class="dt">sample =</span> sample[<span class="dv">3</span>],<span class="dt">media =</span> medias[<span class="dv">3</span>],<span class="dt">desv =</span> desviaciones[<span class="dv">3</span>])</a>
<a class="sourceLine" id="cb621-39" title="39">post_media_mc [<span class="dv">4</span>] &lt;-<span class="st"> </span><span class="kw">media_posterior</span>(<span class="dt">sample =</span> sample[<span class="dv">4</span>],<span class="dt">media =</span> medias[<span class="dv">4</span>],<span class="dt">desv =</span> desviaciones[<span class="dv">4</span>])</a></code></pre></div>
</div>
<div id="intervalos-de-confianza" class="section level2">
<h2><span class="header-section-number">8.7</span> <strong>7. Intervalos de confianza</strong></h2>
<p>Si el interés es construir intervalos de credibilidad simultáneos para todas las diferencias por pares, se puede usar una versión bayesiana de los intervalos de confianza simultáneos de Tukey. Definimos</p>
<p><span class="math display">\[
T^{(2)}=\max_{l} \left\lbrace \left(\left(C_{pk}^{(l)}-E\left(C_{pk}^{(l)}\mid \underline{y} \right)\right) \mid \underline{y} \right) \right\rbrace - \min_{l} \left\lbrace \left(\left(C_{pk}^{(l)}-E\left(C_{pk}^{(l)}\mid \underline{y} \right)\right) \mid \underline{y} \right) \right\rbrace
\]</span></p>
<p>donde <span class="math inline">\(T_{\alpha}^{(2)}\)</span> es el punto porcentual superior <span class="math inline">\(\alpha\)</span> de la distribución de <span class="math inline">\(T^{(2)}\)</span>. Los intervalos de credibilidad simultáneos del <span class="math inline">\(100(1-\alpha)\%\)</span> para todas las diferencias de pares están dados por</p>
<p><span class="math display">\[ 
E\left(C_{pk}^{(i)}\mid \underline{y} \right)-E\left(C_{pk}^{(j)}\mid \underline{y} \right) \pm T_{\alpha}^{(2)} 
\]</span></p>
<p>En donde
<span class="math display">\[
i=1,2,\dots,4 \\ j=1,2,\dots,4 \\ i\neq j
\]</span></p>
<p>100,000 simulaciones Monte Carlo se usaron para calular <span class="math inline">\(E\left(C_{pk}^{(i)}\mid \underline{y} \right)\)</span>,<span class="math inline">\(E\left(C_{pk}^{(j)}\mid \underline{y} \right)\)</span> y <span class="math inline">\(T_{\alpha}^{(2)}\)</span></p>
<p>El procedimiento de simulación es el siguiente:</p>
<ol style="list-style-type: decimal">
<li><p>Simulamos <span class="math inline">\(k\)</span> a partir de la distribución <span class="math inline">\(\chi_{n-1}^2\)</span></p></li>
<li><p>Calcular <span class="math display">\[\sigma_{i}^{2*}=\frac{(n-1)s_{i}^{2}}{k}\]</span></p></li>
</ol>
<p>En donde <span class="math inline">\(*\)</span> indica un valor simulado <span class="math inline">\(i=1,2,\dots,4\)</span></p>
<ol start="3" style="list-style-type: decimal">
<li><p>Notemos que <span class="math display">\[\sigma_{i}^{*}=\sqrt{\sigma_{i}^{2*}} \]</span></p></li>
<li><p>Simulamos <span class="math inline">\(\mu_{i}^{*}\)</span> usando el hecho que <span class="math display">\[\mu_{i}\mid\sigma_{i}^{2},\bar{y_{i}}  \backsim N\left(\bar{y_{i}},\frac{\sigma_{i}^{2}}{n} \right) \]</span></p></li>
<li>Veamos que por definición <span class="math inline">\(C_{pk}^{(i)}\)</span> puede ser simulado por
<span class="math display">\[C_{pk}^{(i)}=min\left(\frac{u-\mu_{i}{*}}{3\sigma_{i}^{*}},\frac{\mu_{i}{*}-l}{3\sigma_{i}^{*}}\right) \]</span></li>
<li><p>Repetir los pasos de 1 al 5 <span class="math inline">\(\hat{l}\)</span>. Para este ejemplo se tiene <span class="math inline">\(\hat{l}=100,000\)</span></p></li>
</ol>
<p>__7.1 **Codigo en R__</p>
<div class="sourceCode" id="cb622"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb622-1" title="1"><span class="co">####Intervalos de CONFIANZA Y FUNCION T_{2}</span></a>
<a class="sourceLine" id="cb622-2" title="2"></a>
<a class="sourceLine" id="cb622-3" title="3">ganesh &lt;-<span class="st"> </span><span class="cf">function</span>(sample,medias,desviaciones,ite,esp)</a>
<a class="sourceLine" id="cb622-4" title="4">{</a>
<a class="sourceLine" id="cb622-5" title="5">  desv &lt;-<span class="st"> </span><span class="kw">vector</span>()</a>
<a class="sourceLine" id="cb622-6" title="6">  cpk &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dt">nrow =</span> <span class="kw">length</span>(medias),<span class="dt">ncol =</span> ite)</a>
<a class="sourceLine" id="cb622-7" title="7">  </a>
<a class="sourceLine" id="cb622-8" title="8">  <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">4</span>) {</a>
<a class="sourceLine" id="cb622-9" title="9">    <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>ite) {</a>
<a class="sourceLine" id="cb622-10" title="10">      k &lt;-<span class="st"> </span><span class="kw">rchisq</span>(<span class="dv">1</span>,<span class="dt">df =</span> sample[j]<span class="op">-</span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb622-11" title="11">      desv &lt;-<span class="st"> </span><span class="kw">sqrt</span>( ((sample[j]<span class="op">-</span><span class="dv">1</span>)<span class="op">*</span>desviaciones[j]<span class="op">^</span><span class="dv">2</span>)<span class="op">/</span>k )</a>
<a class="sourceLine" id="cb622-12" title="12">      mu &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">1</span>,medias[j],(desviaciones[j]<span class="op">^</span><span class="dv">2</span>)<span class="op">/</span>sample[j])</a>
<a class="sourceLine" id="cb622-13" title="13">      cpk[j,i] &lt;-<span class="st"> </span><span class="kw">min</span>((esp[<span class="dv">1</span>]<span class="op">-</span>mu)<span class="op">/</span>(<span class="dv">3</span><span class="op">*</span>desv),(mu<span class="op">-</span>esp[<span class="dv">2</span>])<span class="op">/</span>(<span class="dv">3</span><span class="op">*</span>desv))</a>
<a class="sourceLine" id="cb622-14" title="14">    }</a>
<a class="sourceLine" id="cb622-15" title="15">  }</a>
<a class="sourceLine" id="cb622-16" title="16">  <span class="kw">return</span>(cpk)</a>
<a class="sourceLine" id="cb622-17" title="17">}</a>
<a class="sourceLine" id="cb622-18" title="18"></a>
<a class="sourceLine" id="cb622-19" title="19">ganesho &lt;-<span class="st"> </span><span class="kw">ganesh</span>(<span class="dt">sample =</span> sample,<span class="dt">medias =</span> medias,<span class="dt">desviaciones =</span> desviaciones,<span class="dt">ite =</span> <span class="dv">100000</span>,<span class="dt">esp=</span>esp )</a>
<a class="sourceLine" id="cb622-20" title="20">esperanza &lt;-<span class="st"> </span><span class="kw">apply</span>(ganesho,<span class="dt">FUN =</span> mean,<span class="dt">MARGIN =</span> <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb622-21" title="21">T1 &lt;-<span class="st"> </span><span class="kw">apply</span>(<span class="dt">X =</span> ganesho<span class="op">-</span>esperanza,<span class="dt">MARGIN =</span> <span class="dv">2</span>,<span class="dt">FUN =</span> max)</a>
<a class="sourceLine" id="cb622-22" title="22">T2 &lt;-<span class="st"> </span><span class="kw">apply</span>(<span class="dt">X =</span> ganesho<span class="op">-</span>esperanza,<span class="dt">MARGIN =</span> <span class="dv">2</span>,<span class="dt">FUN =</span> min)</a>
<a class="sourceLine" id="cb622-23" title="23">Tdos &lt;-<span class="st"> </span>T1<span class="op">-</span>T2</a>
<a class="sourceLine" id="cb622-24" title="24"><span class="kw">hist</span>(Tdos,<span class="dt">breaks =</span> <span class="dv">50</span>,<span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">7000</span>),<span class="dt">xlim =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),<span class="dt">main =</span> <span class="st">&quot;Distribucion T_{2}&quot;</span>)</a></code></pre></div>
<p><img src="control_book_files/figure-html/unnamed-chunk-209-1.png" width="672" /></p>
<div class="sourceCode" id="cb623"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb623-1" title="1">q&lt;-<span class="st"> </span><span class="kw">quantile</span>(Tdos, <span class="kw">c</span>(.<span class="dv">95</span>, <span class="fl">.9</span>, <span class="fl">.8747</span>))</a>
<a class="sourceLine" id="cb623-2" title="2"></a>
<a class="sourceLine" id="cb623-3" title="3"></a>
<a class="sourceLine" id="cb623-4" title="4">  Intervalo1 &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;95% Interval -&quot;</span>,</a>
<a class="sourceLine" id="cb623-5" title="5">  <span class="kw">round</span>(<span class="kw">c</span>(esperanza[<span class="dv">1</span>]<span class="op">-</span>esperanza[<span class="dv">2</span>]<span class="op">-</span>q[<span class="dv">1</span>],</a>
<a class="sourceLine" id="cb623-6" title="6">          esperanza[<span class="dv">1</span>]<span class="op">-</span>esperanza[<span class="dv">3</span>]<span class="op">-</span>q[<span class="dv">1</span>],</a>
<a class="sourceLine" id="cb623-7" title="7">          esperanza[<span class="dv">1</span>]<span class="op">-</span>esperanza[<span class="dv">4</span>]<span class="op">-</span>q[<span class="dv">1</span>],</a>
<a class="sourceLine" id="cb623-8" title="8">          esperanza[<span class="dv">2</span>]<span class="op">-</span>esperanza[<span class="dv">3</span>]<span class="op">-</span>q[<span class="dv">1</span>],</a>
<a class="sourceLine" id="cb623-9" title="9">          esperanza[<span class="dv">2</span>]<span class="op">-</span>esperanza[<span class="dv">4</span>]<span class="op">-</span>q[<span class="dv">1</span>],</a>
<a class="sourceLine" id="cb623-10" title="10">          esperanza[<span class="dv">3</span>]<span class="op">-</span>esperanza[<span class="dv">4</span>]<span class="op">-</span>q[<span class="dv">1</span>]),<span class="dv">4</span>))</a>
<a class="sourceLine" id="cb623-11" title="11"></a>
<a class="sourceLine" id="cb623-12" title="12">  Intervalo11 &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;95% Interval +&quot;</span>,</a>
<a class="sourceLine" id="cb623-13" title="13">  <span class="kw">round</span>(<span class="kw">c</span>(esperanza[<span class="dv">1</span>]<span class="op">-</span>esperanza[<span class="dv">2</span>]<span class="op">+</span>q[<span class="dv">1</span>],</a>
<a class="sourceLine" id="cb623-14" title="14">          esperanza[<span class="dv">2</span>]<span class="op">-</span>esperanza[<span class="dv">3</span>]<span class="op">+</span>q[<span class="dv">1</span>],</a>
<a class="sourceLine" id="cb623-15" title="15">          esperanza[<span class="dv">3</span>]<span class="op">-</span>esperanza[<span class="dv">4</span>]<span class="op">+</span>q[<span class="dv">1</span>],</a>
<a class="sourceLine" id="cb623-16" title="16">          esperanza[<span class="dv">3</span>]<span class="op">-</span>esperanza[<span class="dv">3</span>]<span class="op">+</span>q[<span class="dv">1</span>],</a>
<a class="sourceLine" id="cb623-17" title="17">          esperanza[<span class="dv">3</span>]<span class="op">-</span>esperanza[<span class="dv">4</span>]<span class="op">+</span>q[<span class="dv">1</span>],</a>
<a class="sourceLine" id="cb623-18" title="18">          esperanza[<span class="dv">3</span>]<span class="op">-</span>esperanza[<span class="dv">4</span>]<span class="op">+</span>q[<span class="dv">1</span>]),<span class="dv">4</span>))</a>
<a class="sourceLine" id="cb623-19" title="19">  </a>
<a class="sourceLine" id="cb623-20" title="20">  Intervalo2 &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;90% Interval -&quot;</span>,</a>
<a class="sourceLine" id="cb623-21" title="21">  <span class="kw">round</span>(<span class="kw">c</span>(esperanza[<span class="dv">1</span>]<span class="op">-</span>esperanza[<span class="dv">2</span>]<span class="op">-</span>q[<span class="dv">2</span>],</a>
<a class="sourceLine" id="cb623-22" title="22">          esperanza[<span class="dv">1</span>]<span class="op">-</span>esperanza[<span class="dv">3</span>]<span class="op">-</span>q[<span class="dv">2</span>],</a>
<a class="sourceLine" id="cb623-23" title="23">          esperanza[<span class="dv">1</span>]<span class="op">-</span>esperanza[<span class="dv">4</span>]<span class="op">-</span>q[<span class="dv">2</span>],</a>
<a class="sourceLine" id="cb623-24" title="24">          esperanza[<span class="dv">2</span>]<span class="op">-</span>esperanza[<span class="dv">3</span>]<span class="op">-</span>q[<span class="dv">2</span>],</a>
<a class="sourceLine" id="cb623-25" title="25">          esperanza[<span class="dv">2</span>]<span class="op">-</span>esperanza[<span class="dv">4</span>]<span class="op">-</span>q[<span class="dv">2</span>],</a>
<a class="sourceLine" id="cb623-26" title="26">          esperanza[<span class="dv">3</span>]<span class="op">-</span>esperanza[<span class="dv">4</span>]<span class="op">-</span>q[<span class="dv">2</span>]),<span class="dv">4</span>))</a>
<a class="sourceLine" id="cb623-27" title="27">  </a>
<a class="sourceLine" id="cb623-28" title="28">  Intervalo22 &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;90% Interval +&quot;</span>,</a>
<a class="sourceLine" id="cb623-29" title="29">  <span class="kw">round</span>(<span class="kw">c</span>(esperanza[<span class="dv">1</span>]<span class="op">-</span>esperanza[<span class="dv">2</span>]<span class="op">+</span>q[<span class="dv">2</span>],</a>
<a class="sourceLine" id="cb623-30" title="30">          esperanza[<span class="dv">2</span>]<span class="op">-</span>esperanza[<span class="dv">3</span>]<span class="op">+</span>q[<span class="dv">2</span>],</a>
<a class="sourceLine" id="cb623-31" title="31">          esperanza[<span class="dv">3</span>]<span class="op">-</span>esperanza[<span class="dv">4</span>]<span class="op">+</span>q[<span class="dv">2</span>],</a>
<a class="sourceLine" id="cb623-32" title="32">          esperanza[<span class="dv">3</span>]<span class="op">-</span>esperanza[<span class="dv">3</span>]<span class="op">+</span>q[<span class="dv">2</span>],</a>
<a class="sourceLine" id="cb623-33" title="33">          esperanza[<span class="dv">3</span>]<span class="op">-</span>esperanza[<span class="dv">4</span>]<span class="op">+</span>q[<span class="dv">2</span>],</a>
<a class="sourceLine" id="cb623-34" title="34">          esperanza[<span class="dv">3</span>]<span class="op">-</span>esperanza[<span class="dv">4</span>]<span class="op">+</span>q[<span class="dv">2</span>]),<span class="dv">4</span>))</a>
<a class="sourceLine" id="cb623-35" title="35"></a>
<a class="sourceLine" id="cb623-36" title="36">  Intervalo3 &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;87.47% Interval -&quot;</span>,</a>
<a class="sourceLine" id="cb623-37" title="37">  <span class="kw">round</span>(<span class="kw">c</span>(esperanza[<span class="dv">1</span>]<span class="op">-</span>esperanza[<span class="dv">2</span>]<span class="op">-</span>q[<span class="dv">3</span>],</a>
<a class="sourceLine" id="cb623-38" title="38">          esperanza[<span class="dv">1</span>]<span class="op">-</span>esperanza[<span class="dv">3</span>]<span class="op">-</span>q[<span class="dv">3</span>],</a>
<a class="sourceLine" id="cb623-39" title="39">          esperanza[<span class="dv">1</span>]<span class="op">-</span>esperanza[<span class="dv">4</span>]<span class="op">-</span>q[<span class="dv">3</span>],</a>
<a class="sourceLine" id="cb623-40" title="40">          esperanza[<span class="dv">2</span>]<span class="op">-</span>esperanza[<span class="dv">3</span>]<span class="op">-</span>q[<span class="dv">3</span>],</a>
<a class="sourceLine" id="cb623-41" title="41">          esperanza[<span class="dv">2</span>]<span class="op">-</span>esperanza[<span class="dv">4</span>]<span class="op">-</span>q[<span class="dv">3</span>],</a>
<a class="sourceLine" id="cb623-42" title="42">          esperanza[<span class="dv">3</span>]<span class="op">-</span>esperanza[<span class="dv">4</span>]<span class="op">-</span>q[<span class="dv">3</span>]),<span class="dv">4</span>))</a>
<a class="sourceLine" id="cb623-43" title="43">  </a>
<a class="sourceLine" id="cb623-44" title="44">  Intervalo33 &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;87.47% Interval +&quot;</span>,</a>
<a class="sourceLine" id="cb623-45" title="45">  <span class="kw">round</span>(<span class="kw">c</span>(esperanza[<span class="dv">1</span>]<span class="op">-</span>esperanza[<span class="dv">2</span>]<span class="op">+</span>q[<span class="dv">3</span>],</a>
<a class="sourceLine" id="cb623-46" title="46">          esperanza[<span class="dv">2</span>]<span class="op">-</span>esperanza[<span class="dv">3</span>]<span class="op">+</span>q[<span class="dv">3</span>],</a>
<a class="sourceLine" id="cb623-47" title="47">          esperanza[<span class="dv">3</span>]<span class="op">-</span>esperanza[<span class="dv">4</span>]<span class="op">+</span>q[<span class="dv">3</span>],</a>
<a class="sourceLine" id="cb623-48" title="48">          esperanza[<span class="dv">3</span>]<span class="op">-</span>esperanza[<span class="dv">3</span>]<span class="op">+</span>q[<span class="dv">3</span>],</a>
<a class="sourceLine" id="cb623-49" title="49">          esperanza[<span class="dv">3</span>]<span class="op">-</span>esperanza[<span class="dv">4</span>]<span class="op">+</span>q[<span class="dv">3</span>],</a>
<a class="sourceLine" id="cb623-50" title="50">          esperanza[<span class="dv">3</span>]<span class="op">-</span>esperanza[<span class="dv">4</span>]<span class="op">+</span>q[<span class="dv">3</span>]),<span class="dv">4</span>))</a>
<a class="sourceLine" id="cb623-51" title="51">  </a>
<a class="sourceLine" id="cb623-52" title="52">  col &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;E(Cpk i)-E(Cpk j)&quot;</span>,<span class="st">&quot;Supplier-Supplier2&quot;</span>,<span class="st">&quot;Supplier-Supplier3&quot;</span>,<span class="st">&quot;Supplier-Supplier4&quot;</span>,<span class="st">&quot;Supplier2-Supplier3&quot;</span>,<span class="st">&quot;Supplier2-Supplier4&quot;</span>,<span class="st">&quot;Supplier3-Supplier4&quot;</span>)</a>
<a class="sourceLine" id="cb623-53" title="53">  </a>
<a class="sourceLine" id="cb623-54" title="54">misDatos &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">row.names=</span>col,Intervalo1,Intervalo11,Intervalo2,Intervalo22,Intervalo3,Intervalo33)</a>
<a class="sourceLine" id="cb623-55" title="55">misDatos</a></code></pre></div>
<pre><code>##                         Intervalo1    Intervalo11     Intervalo2
## E(Cpk i)-E(Cpk j)   95% Interval - 95% Interval + 90% Interval -
## Supplier-Supplier2         -0.0522         0.8679         0.0015
## Supplier-Supplier3          -0.257         0.2552        -0.2033
## Supplier-Supplier4         -0.4758         0.2413        -0.4221
## Supplier2-Supplier3        -0.6649           0.46        -0.6112
## Supplier2-Supplier4        -0.8837         0.2413          -0.83
## Supplier3-Supplier4        -0.6788         0.2413        -0.6251
##                        Intervalo22        Intervalo3       Intervalo33
## E(Cpk i)-E(Cpk j)   90% Interval + 87.47% Interval - 87.47% Interval +
## Supplier-Supplier2          0.8143            0.0199            0.7959
## Supplier-Supplier3          0.2015           -0.1849            0.1831
## Supplier-Supplier4          0.1876           -0.4037            0.1692
## Supplier2-Supplier3         0.4064           -0.5928             0.388
## Supplier2-Supplier4         0.1876           -0.8116            0.1692
## Supplier3-Supplier4         0.1876           -0.6068            0.1692</code></pre>
<p><img src="control_book_files/figure-html/unnamed-chunk-210-1.png" width="672" /></p>
</div>
<div id="distribucion-posterior-dec_pl-y-c_pu" class="section level2">
<h2><span class="header-section-number">8.8</span> <strong>8. Distribución posterior de:</strong><span class="math inline">\(C_{pl}\)</span> y <span class="math inline">\(C_{pu}\)</span></h2>
<p>Podría ser interesante observar también las distribuciones posteriores de <span class="math inline">\(C_{pl}=\frac{\mu-l}{3\sigma}\)</span> y <span class="math inline">\(C_{pu}=\frac{u-\mu}{3\sigma}\)</span>. La distribución posterior de <span class="math inline">\(C_{pl}\)</span> esta dada por
<span class="math display">\[
p\left ( t\mid \hat{t} \right )=\frac{3\sqrt{n} exp(-\frac{9nt^2}{2})}{\Gamma{\frac{v}{2}}\sqrt{2\pi}}\sum_{j=1}^{\infty}\left(\frac{9nt\hat{t}}{\sqrt{v}}\right)^j \frac{1}{j!} \frac{\Gamma{\frac{v+j}{2}}2^{\frac{j}{2}}}{(1+\frac{9n\hat{t}^2}{v})^\frac{v+j}{2}}
\]</span>
como vimos anteriormente. Una forma mucho más fácil de obtener la distribución posterior es simular un gran número de distribuciones posteriores condicionales. El promedio de estas distribuciones condicionales es entonces la distribución posterior incondicional de <span class="math inline">\(C_{pl}\)</span>. This procedure is called the Rao-Blackwell method.</p>
<div id="codigo-en-r__-1" class="section level3">
<h3><span class="header-section-number">8.8.1</span> __8.1 **Codigo en R__</h3>
<div class="sourceCode" id="cb625"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb625-1" title="1"><span class="co">####FUNCION POSTERIOR DEL CPL</span></a>
<a class="sourceLine" id="cb625-2" title="2"></a>
<a class="sourceLine" id="cb625-3" title="3">posterior_di&lt;-<span class="cf">function</span>(inf,y,l,s,n,t){</a>
<a class="sourceLine" id="cb625-4" title="4">  t_techo&lt;-(y<span class="op">-</span>l)<span class="op">/</span>(<span class="dv">3</span><span class="op">*</span>s)</a>
<a class="sourceLine" id="cb625-5" title="5">  v&lt;-n<span class="dv">-1</span></a>
<a class="sourceLine" id="cb625-6" title="6">  c&lt;-(<span class="dv">3</span><span class="op">*</span><span class="kw">sqrt</span>(n)<span class="op">*</span><span class="kw">exp</span>((<span class="op">-</span><span class="dv">9</span><span class="op">*</span>n<span class="op">*</span>(t<span class="op">^</span><span class="dv">2</span>))<span class="op">/</span><span class="dv">2</span>))<span class="op">/</span>(<span class="kw">gamma</span>(v<span class="op">/</span><span class="dv">2</span>)<span class="op">*</span><span class="kw">sqrt</span>(<span class="dv">2</span><span class="op">*</span>pi))</a>
<a class="sourceLine" id="cb625-7" title="7">  g&lt;-<span class="dv">0</span></a>
<a class="sourceLine" id="cb625-8" title="8">  <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">0</span><span class="op">:</span>inf) {</a>
<a class="sourceLine" id="cb625-9" title="9">    g &lt;-<span class="st"> </span>g<span class="op">+</span>(((<span class="dv">9</span><span class="op">*</span>n<span class="op">*</span>t<span class="op">*</span>t_techo)<span class="op">/</span><span class="kw">sqrt</span>(v))<span class="op">^</span>j)<span class="op">*</span>(<span class="dv">1</span><span class="op">/</span><span class="kw">factorial</span>(j))<span class="op">*</span>((<span class="kw">gamma</span>((v<span class="op">+</span>j)<span class="op">/</span><span class="dv">2</span>)<span class="op">*</span>(<span class="dv">2</span><span class="op">^</span>(j<span class="op">/</span><span class="dv">2</span>)))<span class="op">/</span>(<span class="dv">1</span><span class="op">+</span>((<span class="dv">9</span><span class="op">*</span>n<span class="op">*</span>(t_techo<span class="op">^</span><span class="dv">2</span>))<span class="op">/</span>v))<span class="op">^</span>((v<span class="op">+</span>j)<span class="op">/</span><span class="dv">2</span>))</a>
<a class="sourceLine" id="cb625-10" title="10">  }</a>
<a class="sourceLine" id="cb625-11" title="11">  <span class="kw">return</span>(c<span class="op">*</span>g)</a>
<a class="sourceLine" id="cb625-12" title="12">}</a>
<a class="sourceLine" id="cb625-13" title="13">max1 &lt;-<span class="st"> </span><span class="dv">100</span></a>
<a class="sourceLine" id="cb625-14" title="14">posterior_cpl&lt;-<span class="cf">function</span>(x){</a>
<a class="sourceLine" id="cb625-15" title="15">  <span class="kw">return</span>(<span class="kw">posterior_di</span>(<span class="dt">t =</span> x,<span class="dt">inf =</span> max1,<span class="dt">y =</span> medias[<span class="dv">1</span>],<span class="dt">l =</span>esp[<span class="dv">2</span>],<span class="dt">s =</span> desviaciones[<span class="dv">1</span>],<span class="dt">n=</span>sample[<span class="dv">1</span>]))</a>
<a class="sourceLine" id="cb625-16" title="16">}</a>
<a class="sourceLine" id="cb625-17" title="17">posterior_cpl1&lt;-<span class="cf">function</span>(x){</a>
<a class="sourceLine" id="cb625-18" title="18">  <span class="kw">return</span>(<span class="kw">posterior_di</span>(<span class="dt">t =</span> x,<span class="dt">inf =</span> max1,<span class="dt">y =</span> medias[<span class="dv">2</span>],<span class="dt">l =</span>esp[<span class="dv">2</span>],<span class="dt">s =</span> desviaciones[<span class="dv">2</span>],<span class="dt">n=</span>sample[<span class="dv">2</span>]))</a>
<a class="sourceLine" id="cb625-19" title="19">}</a>
<a class="sourceLine" id="cb625-20" title="20">posterior_cpl2&lt;-<span class="cf">function</span>(x){</a>
<a class="sourceLine" id="cb625-21" title="21">  <span class="kw">return</span>(<span class="kw">posterior_di</span>(<span class="dt">t =</span> x,<span class="dt">inf =</span> max1,<span class="dt">y =</span> medias[<span class="dv">3</span>],<span class="dt">l =</span>esp[<span class="dv">2</span>],<span class="dt">s =</span> desviaciones[<span class="dv">3</span>],<span class="dt">n=</span>sample[<span class="dv">3</span>]))</a>
<a class="sourceLine" id="cb625-22" title="22">}</a>
<a class="sourceLine" id="cb625-23" title="23">posterior_cpl3&lt;-<span class="cf">function</span>(x){</a>
<a class="sourceLine" id="cb625-24" title="24">  <span class="kw">return</span>(<span class="kw">posterior_di</span>(<span class="dt">t =</span> x,<span class="dt">inf =</span> max1,<span class="dt">y =</span> medias[<span class="dv">4</span>],<span class="dt">l =</span>esp[<span class="dv">2</span>],<span class="dt">s =</span> desviaciones[<span class="dv">4</span>],<span class="dt">n=</span>sample[<span class="dv">4</span>]))</a>
<a class="sourceLine" id="cb625-25" title="25">}</a>
<a class="sourceLine" id="cb625-26" title="26"><span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">2</span>))</a>
<a class="sourceLine" id="cb625-27" title="27"><span class="kw">plot</span>(posterior_cpl,<span class="dt">col=</span><span class="st">&quot;black&quot;</span>)</a>
<a class="sourceLine" id="cb625-28" title="28"><span class="kw">plot</span>(posterior_cpl1,<span class="dt">col=</span><span class="st">&quot;red&quot;</span>)</a>
<a class="sourceLine" id="cb625-29" title="29"><span class="kw">plot</span>(posterior_cpl2,<span class="dt">col=</span><span class="st">&quot;blue&quot;</span>)</a>
<a class="sourceLine" id="cb625-30" title="30"><span class="kw">plot</span>(posterior_cpl3,<span class="dt">col=</span><span class="st">&quot;green&quot;</span>)</a></code></pre></div>
<p><img src="control_book_files/figure-html/unnamed-chunk-211-1.png" width="672" /></p>
</div>
</div>
<div id="conclusiones" class="section level2">
<h2><span class="header-section-number">8.9</span> <strong>9. Conclusiones</strong></h2>
<ul>
<li>Como primer punto se notó que para la aproximación de la integral propuesta en el literal 5 es mejor usar una integración numérica puesto que la aproximación por Monte Carlo, computacionalmente es muy costosa. Esto lo hemos podido evidenciar ya que planteamos un código para cada método, y el resultado arrojó que el método de Monte Carlo se demoraba horas, a diferencia de la integración numérica en donde se obtuvo los resultados en par de minutos. Si la integral es en más de 5 dimensiones se recomiendo usar el método de Monte Carlo.<br />
</li>
<li>Durante la realización del proyecto, específicamente para hallar la media y varianza posteriores de los <span class="math inline">\(C_{pk}\)</span>, se vio la necesidad de utilizar un algoritmo de aceptación-rechazo para generar una muestra que siga la distribución posterior, con lo cual se observó que se debe usar una función cercana para tener una rápida formación de la muestra</li>
<li>Del grafico obtenido en el literal 6 se puede deducir que el proveedor 1 y 4 son mejores puesto que las medias de los <span class="math inline">\(C_{pk}\)</span> son mayores que 1.5 y la teoría nos dice que si un <span class="math inline">\(C_{pk}\)</span> es mayor que 1.25 se tiene que el proceso es capaz, notemos que el proveedor 3 tiene su media en 1.32, es decir, ese proceso es capaz pero no en la medida que son 1 y 4. Finalmente como el proveedor 4 tiene menos variabilidad, se lo considerará como el mejor.</li>
<li>Por otro lado el hecho de suponer que la muestra sigue una distribución normal y usando la función de Jeffrey como función a priori, se dedujo que la distribución posterior del <span class="math inline">\(C_{pk}\)</span> sigue una normal con media cercana al <span class="math inline">\(\hat{C_{pk}}\)</span> (<span class="math inline">\(C_{pk}\)</span> estimado).</li>
<li>Finalmente se cree que el método Bayesiano puede llegar a ser más general en comparación al método clásico, puesto que podemos plantear una función a priori que describa de cierta forma el parámetro que se pretende analizar.
___</li>
</ul>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="apuntes-de-control-y-aseguramiento-de-la-calidad.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="control-no-parametrico.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"download": ["control_book.pdf", "control_book.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
